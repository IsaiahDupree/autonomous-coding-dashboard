[
  {"id":"AAG-001","name":"Database migration — all acquisition tables","description":"Create 001_acquisition_tables.sql with all 10 new tables: acq_niche_configs, acq_discovery_runs, acq_warmup_schedules, acq_warmup_configs, acq_outreach_sequences, acq_human_notifications, acq_daily_caps, acq_weekly_reports, acq_message_variants, acq_funnel_events","category":"database","priority":1,"status":"pending","prd":"PRD-022"},
  {"id":"AAG-002","name":"Database query layer — acquisition/db/queries.py","description":"Typed async functions for all SQL operations across the 10 acquisition tables. Uses httpx Supabase REST client pattern matching crm_brain.py","category":"database","priority":1,"status":"pending","prd":"PRD-022"},
  {"id":"AAG-003","name":"NicheConfig data model + CRUD","description":"Pydantic model for acq_niche_configs. CRUD operations: create, read, update, deactivate. Validate that at least one platform and one keyword are provided","category":"database","priority":1,"status":"pending","prd":"PRD-022"},
  {"id":"AAG-004","name":"Seed default niche configs","description":"Seed 3 starter niche configs: 'ai-automation-coaches' (IG/TW/TT), 'agency-owners-b2b' (LI/TW), 'content-creators-growth' (TT/IG/Threads). Each with keywords, ICP min score, and weekly max","category":"database","priority":2,"status":"pending","prd":"PRD-022"},
  {"id":"AAG-005","name":"MarketResearchClient wrapper for discovery","description":"Async Python client calling Market Research API (port 3106). Methods: search_platform(platform, keyword, max_results), get_top_creators(platform, niche, limit). Returns normalized ProspectData objects","category":"integration","priority":1,"status":"pending","prd":"PRD-022"},
  {"id":"AAG-006","name":"DeduplicationEngine","description":"Check crm_contacts for existing handles before inserting. Query: SELECT id FROM crm_contacts WHERE instagram_handle=$1 OR twitter_handle=$1 OR tiktok_handle=$1 OR linkedin_url=$1. Returns existing_id or None","category":"agent","priority":1,"status":"pending","prd":"PRD-022"},
  {"id":"AAG-007","name":"ContactSeeder — upsert discovered prospects to crm_contacts","description":"Upsert new prospects to crm_contacts with pipeline_stage='new'. Map platform handles, follower count, top post data, niche label, source_niche_config_id. Never overwrite existing data if contact already exists","category":"agent","priority":1,"status":"pending","prd":"PRD-022"},
  {"id":"AAG-008","name":"DiscoveryAgent.run() — main discovery loop","description":"For each active niche config: for each platform × keyword combination, call MarketResearchClient, deduplicate, seed contacts. Log results to acq_discovery_runs. Return DiscoveryResult with counts","category":"agent","priority":1,"status":"pending","prd":"PRD-022"},
  {"id":"AAG-009","name":"TikTok creator enrichment in discovery","description":"After seeding TikTok contacts, call enrichment endpoint to pull follower count. Update crm_contacts.follower_count_tiktok. Skip if already enriched in last 7 days","category":"integration","priority":2,"status":"pending","prd":"PRD-022"},
  {"id":"AAG-010","name":"LinkedIn discovery via li_prospect.py integration","description":"Call li_prospect.py --search for LinkedIn-targeted niche configs. Parse stdout output into ProspectData objects. Add to discovery pipeline","category":"integration","priority":2,"status":"pending","prd":"PRD-022"},
  {"id":"AAG-011","name":"Discovery rate limiter — max 3 concurrent platform scans","description":"Use asyncio.Semaphore(3) to limit concurrent Market Research API calls. Add 5s delay between requests to same platform to avoid rate limits","category":"agent","priority":2,"status":"pending","prd":"PRD-022"},
  {"id":"AAG-012","name":"Discovery run logging","description":"INSERT to acq_discovery_runs after each platform×keyword scan: niche_config_id, platform, keyword, discovered, deduplicated, seeded, errors[], duration_ms","category":"agent","priority":2,"status":"pending","prd":"PRD-022"},
  {"id":"AAG-013","name":"POST /api/acquisition/discovery/run endpoint","description":"HTTP endpoint to trigger a discovery run for a specific niche config and platform. Accepts dry_run flag. Returns run stats synchronously for configs that complete in <30s, otherwise returns run_id for polling","category":"api","priority":2,"status":"pending","prd":"PRD-022"},
  {"id":"AAG-014","name":"GET /api/acquisition/discovery/runs endpoint","description":"List recent discovery runs with pagination. Filter by niche_config_id, platform, date range. Returns run stats including error summaries","category":"api","priority":3,"status":"pending","prd":"PRD-022"},
  {"id":"AAG-015","name":"POST/GET /api/acquisition/niches endpoints","description":"CRUD endpoints for niche configs. POST creates, PUT updates, DELETE deactivates. GET lists all with last_run stats joined","category":"api","priority":2,"status":"pending","prd":"PRD-022"},
  {"id":"AAG-016","name":"Discovery CLI — python3 acquisition/discovery_agent.py --run","description":"CLI flags: --niche-id, --platform, --dry-run, --limit. Prints discovered/seeded counts per niche. Matches crm_brain.py CLI pattern","category":"setup","priority":2,"status":"pending","prd":"PRD-022"},
  {"id":"AAG-017","name":"Re-entry logic — allow archived contacts back after 180 days","description":"Before seeding: check if contact exists with pipeline_stage='archived' and archived_at < NOW()-180days. If so, reset to pipeline_stage='new' rather than creating duplicate","category":"agent","priority":2,"status":"pending","prd":"PRD-022"},
  {"id":"AAG-018","name":"Closed-lost re-entry after 90 days","description":"Same re-entry logic for closed_lost contacts. Reset after 90 days. Add re_entry_count field to crm_contacts to track how many times contact has re-entered pipeline","category":"agent","priority":3,"status":"pending","prd":"PRD-022"},
  {"id":"AAG-019","name":"Discovery tests — unit tests for dedup, seeding, run logging","description":"pytest tests: test_dedup_existing_contact, test_seed_new_contact, test_discovery_run_logging, test_rate_limiter, test_reentry_logic. Mock Market Research API responses","category":"testing","priority":2,"status":"pending","prd":"PRD-022"},
  {"id":"AAG-020","name":"Discovery health check endpoint","description":"GET /api/acquisition/discovery/health — returns service status, last successful run timestamp per niche, contacts seeded this week","category":"api","priority":3,"status":"pending","prd":"PRD-022"},

  {"id":"AAG-021","name":"ICPScoringAgent — Claude batch scoring","description":"Read all crm_contacts WHERE relationship_score IS NULL AND pipeline_stage='new'. For each, call Claude with contact data. Store score + reasoning in crm_score_history and crm_contacts.relationship_score","category":"agent","priority":1,"status":"pending","prd":"PRD-022"},
  {"id":"AAG-022","name":"ICP scoring prompt — configurable per niche","description":"Store scoring prompt template in acq_niche_configs.scoring_prompt. Default prompt evaluates: active posting, engagement rate, niche relevance, follower count range, content type fit. Score 0-100 with 1-sentence reasoning","category":"agent","priority":1,"status":"pending","prd":"PRD-022"},
  {"id":"AAG-023","name":"Score routing — auto-advance to 'qualified'","description":"After scoring, apply routing: score>=65 → UPDATE pipeline_stage='qualified'; score<65 → pipeline_stage='archived'. INSERT to acq_funnel_events for each transition","category":"agent","priority":1,"status":"pending","prd":"PRD-022"},
  {"id":"AAG-024","name":"Configurable ICP min_score per niche","description":"Read acq_niche_configs.icp_min_score for routing threshold (default 65). Allow per-niche override so B2B LinkedIn niche can use 72 while creator niches use 60","category":"agent","priority":2,"status":"pending","prd":"PRD-022"},
  {"id":"AAG-025","name":"Batch scoring with Claude Haiku for cost efficiency","description":"Use claude-3-haiku for batch scoring (cost ~$0.001/contact). Batch up to 20 contacts per API call using a structured JSON output prompt. Fall back to individual calls if batch fails","category":"agent","priority":2,"status":"pending","prd":"PRD-022"},
  {"id":"AAG-026","name":"Score history tracking in crm_score_history","description":"Every score update creates a record in crm_score_history: contact_id, score, reasoning, model_used, scored_at. Supports score drift tracking over time","category":"database","priority":2,"status":"pending","prd":"PRD-022"},
  {"id":"AAG-027","name":"Re-scoring on new post data","description":"If contact's crm_market_research data was updated in last 7 days and last score is >30 days old, flag for re-scoring. Auto-queue re-score in nightly batch","category":"agent","priority":3,"status":"pending","prd":"PRD-022"},
  {"id":"AAG-028","name":"POST /api/acquisition/score endpoint","description":"Trigger scoring for a batch of contacts. Accepts contact_ids[] or niche_config_id + limit. Returns scored_count, qualified_count, archived_count","category":"api","priority":2,"status":"pending","prd":"PRD-022"},
  {"id":"AAG-029","name":"Scoring CLI — python3 acquisition/scoring_agent.py --run","description":"CLI flags: --limit N, --niche-id, --dry-run, --rescore-stale. Print score distribution histogram after run","category":"setup","priority":2,"status":"pending","prd":"PRD-022"},
  {"id":"AAG-030","name":"Scoring tests","description":"pytest: test_scoring_prompt_generates_valid_json, test_batch_scoring, test_score_routing_qualified, test_score_routing_archived, test_rescore_stale_logic","category":"testing","priority":2,"status":"pending","prd":"PRD-022"},

  {"id":"AAG-031","name":"WarmupConfig model + defaults","description":"Pydantic model and Supabase table for acq_warmup_configs. Default: 2 comments over 5 days, min 20h gap, AI comments enabled, tone=insightful. One config per niche","category":"database","priority":1,"status":"pending","prd":"PRD-023"},
  {"id":"AAG-032","name":"PostFetcher — get prospect's recent posts for warmup context","description":"First check crm_market_research for cached posts. If none or stale (>7 days), call Market Research API for 3 most recent posts. Return PostData list sorted by engagement desc","category":"agent","priority":1,"status":"pending","prd":"PRD-023"},
  {"id":"AAG-033","name":"CommentGenerator — Claude-powered per-post comments","description":"For each post, call Claude (claude-3-haiku) with post text + niche context. Generate 1-2 sentence insightful comment. Validate: not generic, references specific content, no pitch. Retry once if validation fails","category":"agent","priority":1,"status":"pending","prd":"PRD-023"},
  {"id":"AAG-034","name":"WarmupScheduler — schedule N comments over window_days","description":"Given a qualified contact and warmup config, create acq_warmup_schedules rows. Spread comments across window_days with randomized times (8AM–6PM). Never same-day as another comment to same contact","category":"agent","priority":1,"status":"pending","prd":"PRD-023"},
  {"id":"AAG-035","name":"Warmup batch scheduler — process all newly-qualified contacts","description":"Read crm_contacts WHERE pipeline_stage='qualified' AND id NOT IN (SELECT contact_id FROM acq_warmup_schedules). Create warmup schedules for all. UPDATE pipeline_stage='warming'","category":"agent","priority":1,"status":"pending","prd":"PRD-023"},
  {"id":"AAG-036","name":"CommentSender — send scheduled warmup comments","description":"Read acq_warmup_schedules WHERE status='pending' AND scheduled_at <= NOW(). For each, call correct comment service endpoint. Update status='sent', comment_id, sent_at. Handle failures gracefully","category":"agent","priority":1,"status":"pending","prd":"PRD-023"},
  {"id":"AAG-037","name":"Platform comment endpoint routing","description":"Map platform → comment service: instagram→3005 /api/instagram/comments/post, twitter→3007 /api/twitter/comments/post (useAI:false, text provided), tiktok→3006, threads→3004","category":"integration","priority":1,"status":"pending","prd":"PRD-023"},
  {"id":"AAG-038","name":"CommentRateLimiter — max N comments per platform per day","description":"Before sending any comment, check acq_daily_caps for comments action + platform. If at limit, skip and reschedule to tomorrow. Default caps: IG=25, TW=40, TT=25, Threads=30","category":"agent","priority":1,"status":"pending","prd":"PRD-023"},
  {"id":"AAG-039","name":"Duplicate post guard — never comment twice on same post","description":"Before scheduling, check acq_warmup_schedules WHERE contact_id=$1 AND post_url=$2. Skip post if already scheduled or sent. Select next best post from PostFetcher result","category":"agent","priority":1,"status":"pending","prd":"PRD-023"},
  {"id":"AAG-040","name":"Warmup completion detection + stage advance","description":"After each comment send, check: does this contact now have >= warmup_target comments sent? If yes, UPDATE crm_contacts SET pipeline_stage='ready_for_dm'. INSERT acq_funnel_events","category":"agent","priority":1,"status":"pending","prd":"PRD-023"},
  {"id":"AAG-041","name":"Warmup window timeout — advance even if target not met","description":"If warmup window_days have elapsed but comment target not met (failed sends), advance to ready_for_dm anyway with skip_warmup=true flag. Log reason in acq_funnel_events.metadata","category":"agent","priority":2,"status":"pending","prd":"PRD-023"},
  {"id":"AAG-042","name":"crm_messages write after every sent warmup comment","description":"INSERT to crm_messages: platform, username=post_url, message_text=comment_text, message_type='comment', is_outbound=true, sent_by_automation=true, metadata={commentId, postUrl, warmup=true}","category":"integration","priority":1,"status":"pending","prd":"PRD-023"},
  {"id":"AAG-043","name":"POST /api/acquisition/warmup/schedule endpoint","description":"Schedule warmup for a batch of contact_ids. Accepts optional override_config. Returns scheduled_count, posts_found, errors","category":"api","priority":2,"status":"pending","prd":"PRD-023"},
  {"id":"AAG-044","name":"POST /api/acquisition/warmup/execute endpoint","description":"Execute pending warmup comments. Accepts platform filter, limit. Returns sent_count, skipped_count, failed_count. Called by cron","category":"api","priority":2,"status":"pending","prd":"PRD-023"},
  {"id":"AAG-045","name":"GET /api/acquisition/warmup/status endpoint","description":"Return warmup pipeline status: pending schedule count, sent today per platform, contacts currently warming, contacts ready_for_dm, completion rate","category":"api","priority":2,"status":"pending","prd":"PRD-023"},
  {"id":"AAG-046","name":"Warmup CLI — python3 acquisition/warmup_agent.py","description":"CLI flags: --schedule (process qualified contacts), --execute (send pending), --status, --dry-run, --platform. Print per-platform counts","category":"setup","priority":2,"status":"pending","prd":"PRD-023"},
  {"id":"AAG-047","name":"Warmup tests","description":"pytest: test_comment_generator_not_generic, test_schedule_spreads_over_window, test_duplicate_post_guard, test_rate_limit_enforcement, test_stage_advance_on_completion, test_window_timeout_advance","category":"testing","priority":2,"status":"pending","prd":"PRD-023"},
  {"id":"AAG-048","name":"Warmup config per niche — different tone per service","description":"LinkedIn niche: tone=professional, 2 comments. Creator niche: tone=encouraging, 3 comments. AI tools niche: tone=curious. Stored in acq_warmup_configs linked to niche_config_id","category":"setup","priority":3,"status":"pending","prd":"PRD-023"},
  {"id":"AAG-049","name":"Warmup analytics — comment to DM reply rate correlation","description":"Track: did contacts who received 3 warmup comments reply to DM at higher rate than 0 or 1? Log correlation in acq_weekly_reports.insights for human review","category":"reporting","priority":3,"status":"pending","prd":"PRD-023"},
  {"id":"AAG-050","name":"Warmup skip option for high-score contacts","description":"If contact ICP score >= 85, skip warmup entirely and advance directly to ready_for_dm. Configurable threshold in acq_niche_configs.skip_warmup_min_score","category":"agent","priority":3,"status":"pending","prd":"PRD-023"},

  {"id":"AAG-051","name":"ContextBuilder — build contact brief for DM generation","description":"For a contact, compile: display_name, platform, handle, score, score_reasoning, top 2 posts from crm_market_research, niche label, follower_count. Return ContactBrief dataclass","category":"agent","priority":1,"status":"pending","prd":"PRD-024"},
  {"id":"AAG-052","name":"MessageGenerator — Claude first DM generation","description":"Call Claude (claude-3-5-sonnet) with ContactBrief + service description + DM prompt template from PRD-024. Validate: max 4 sentences, no pitch, no generic opener, references their content. Retry once if validation fails","category":"agent","priority":1,"status":"pending","prd":"PRD-024"},
  {"id":"AAG-053","name":"MessageValidator — quality gate before send","description":"Rules: length <= 280 chars (Twitter), <= 500 chars (others). Must contain prospect-specific reference. Must not contain 'hope this finds', 'reach out', 'synergy', 'pick your brain'. Score 0-10, reject if <6","category":"agent","priority":1,"status":"pending","prd":"PRD-024"},
  {"id":"AAG-054","name":"SendRouter — platform → DM service mapping","description":"Map crm_contacts.primary_platform → DM service port + endpoint. Handle: instagram→3001 /api/messages/send-to, twitter→3003, tiktok→3102, linkedin→3105 (open+send flow). Return route config","category":"agent","priority":1,"status":"pending","prd":"PRD-024"},
  {"id":"AAG-055","name":"DMSender — send first DM + record result","description":"POST to DM service, parse success/failure response. On success: UPDATE pipeline_stage='contacted', INSERT crm_messages, INSERT acq_outreach_sequences (touch=1), INSERT acq_funnel_events. On failure: retry once after 60s, then mark failed","category":"agent","priority":1,"status":"pending","prd":"PRD-024"},
  {"id":"AAG-056","name":"Daily cap check before any DM send","description":"Check acq_daily_caps for dm + platform. If at limit, skip contact and mark acq_outreach_sequences.status='skipped', skip_reason='daily_cap'. Reschedule for tomorrow","category":"agent","priority":1,"status":"pending","prd":"PRD-024"},
  {"id":"AAG-057","name":"Outreach batch processor — process all ready_for_dm contacts","description":"Read crm_contacts WHERE pipeline_stage='ready_for_dm'. For each, run ContextBuilder → MessageGenerator → MessageValidator → SendRouter → DMSender. Respect daily cap across the batch","category":"agent","priority":1,"status":"pending","prd":"PRD-024"},
  {"id":"AAG-058","name":"Outreach queue — stage DMs for later send","description":"Generated messages written to crm_message_queue with status='pending_send', scheduled_at. Separate step sends them. Allows human preview before send if desired (dry_run flag inserts to queue but doesnt send)","category":"agent","priority":2,"status":"pending","prd":"PRD-024"},
  {"id":"AAG-059","name":"Service slug context per contact","description":"Each contact in acq_outreach_sequences has a service_slug field. Message generation uses service_description from that service's config. One contact can only be in one active service sequence at a time","category":"agent","priority":2,"status":"pending","prd":"PRD-024"},
  {"id":"AAG-060","name":"LinkedIn open+send DM flow","description":"LinkedIn DM requires 2 steps: POST /api/linkedin/messages/open {participantName}, then POST /api/linkedin/messages/send {text}. Wrap this in DMSender as linkedin_send() with retry logic","category":"integration","priority":1,"status":"pending","prd":"PRD-024"},
  {"id":"AAG-061","name":"POST /api/acquisition/outreach/generate endpoint","description":"Preview DM for a single contact without sending. Returns message_text, platform, validation_score, estimated_send_at. For human review before enabling auto-send","category":"api","priority":2,"status":"pending","prd":"PRD-024"},
  {"id":"AAG-062","name":"POST /api/acquisition/outreach/send endpoint","description":"Send pending outreach for up to N contacts. Accepts service_slug filter, limit, dry_run. Returns sent[], skipped[], failed[] with reasons","category":"api","priority":2,"status":"pending","prd":"PRD-024"},
  {"id":"AAG-063","name":"Outreach CLI — python3 acquisition/outreach_agent.py","description":"CLI flags: --generate (preview next N DMs), --send (send pending), --dry-run, --limit, --service. Print each DM with contact name and validation score","category":"setup","priority":2,"status":"pending","prd":"PRD-024"},
  {"id":"AAG-064","name":"Outreach tests","description":"pytest: test_context_builder_includes_posts, test_message_validator_rejects_generic, test_send_router_correct_port, test_daily_cap_blocks_send, test_linkedin_open_send_flow, test_message_written_to_crm_messages","category":"testing","priority":2,"status":"pending","prd":"PRD-024"},

  {"id":"AAG-065","name":"ReplyDetector — sync inboxes and detect new replies","description":"Call crm_brain.py --sync (or replicate its logic inline). After sync, query: SELECT id FROM crm_contacts WHERE pipeline_stage='contacted' AND last_inbound_at > last_outbound_at. These are replies","category":"agent","priority":1,"status":"pending","prd":"PRD-024"},
  {"id":"AAG-066","name":"Reply handler — advance stage + queue human notification","description":"On reply detected: UPDATE pipeline_stage='replied'. INSERT acq_funnel_events. INSERT acq_human_notifications with AI-generated 2-sentence summary of the conversation","category":"agent","priority":1,"status":"pending","prd":"PRD-024"},
  {"id":"AAG-067","name":"Human notification — Apple push on reply","description":"Call mcp0_notifications_send_notification: title='New Reply from {name}', message='{summary} — replied on {platform}'. Include Supabase contact URL in message","category":"integration","priority":1,"status":"pending","prd":"PRD-024"},
  {"id":"AAG-068","name":"Human notification — email on reply","description":"Call mcp0_mail_create_email: subject='[CRM] Reply from {name} on {platform}', body=full conversation summary + contact brief + recommended response angle","category":"integration","priority":2,"status":"pending","prd":"PRD-024"},
  {"id":"AAG-069","name":"Conversation summary generator for human handoff","description":"When reply detected, call Claude with full crm_messages thread for this contact. Generate: 2-sentence summary, sentiment (positive/neutral/objection), recommended_response_angle. Store in acq_human_notifications.summary","category":"agent","priority":2,"status":"pending","prd":"PRD-024"},
  {"id":"AAG-070","name":"Follow-up 1 generator (Day 4)","description":"For contacts: pipeline_stage='contacted', last_outbound_at < NOW()-3days, no inbound. Generate Day 4 follow-up. Different angle (social proof or result-focused). Claude with FollowUp1 prompt template","category":"agent","priority":1,"status":"pending","prd":"PRD-024"},
  {"id":"AAG-071","name":"Follow-up 2 generator (Day 7)","description":"For contacts: pipeline_stage='follow_up_1', last_outbound_at < NOW()-3days, no inbound. Generate Day 7 close-the-loop message. 1-2 sentences, acknowledges last message, leaves door open","category":"agent","priority":1,"status":"pending","prd":"PRD-024"},
  {"id":"AAG-072","name":"Archive handler — move to archived after Day 7 no-reply","description":"For contacts: pipeline_stage='follow_up_2', last_outbound_at < NOW()-3days, no inbound. UPDATE pipeline_stage='archived', SET archived_at=NOW(). INSERT acq_funnel_events","category":"agent","priority":1,"status":"pending","prd":"PRD-024"},
  {"id":"AAG-073","name":"POST /api/acquisition/followup/process endpoint","description":"Run full follow-up cycle: sync inboxes, detect replies, send due follow-ups, archive timed-out. Returns replied[], followup_1_sent[], followup_2_sent[], archived[]","category":"api","priority":2,"status":"pending","prd":"PRD-024"},
  {"id":"AAG-074","name":"Follow-up CLI — python3 acquisition/followup_agent.py","description":"CLI flags: --process, --dry-run, --show-pending. Show table of contacts due for follow-up with days since last touch","category":"setup","priority":2,"status":"pending","prd":"PRD-024"},
  {"id":"AAG-075","name":"Follow-up tests","description":"pytest: test_reply_detector_finds_inbound, test_stage_advance_to_replied, test_followup1_triggers_at_day4, test_followup2_triggers_at_day7, test_archive_after_day7_noreply, test_human_notification_sent","category":"testing","priority":2,"status":"pending","prd":"PRD-024"},

  {"id":"AAG-076","name":"StateMachine — valid transition enforcement","description":"state_machine.py: VALID_TRANSITIONS dict. Function validate_transition(from_stage, to_stage) → raises InvalidTransitionError if not valid. All pipeline_stage updates must go through this","category":"orchestrator","priority":1,"status":"pending","prd":"PRD-025"},
  {"id":"AAG-077","name":"DailyCapManager — init and reset daily caps","description":"On startup: ensure acq_daily_caps rows exist for all platform×action combinations. At midnight UTC: reset sent_today=0 for all rows. Expose check_cap(action, platform) and increment_cap(action, platform)","category":"orchestrator","priority":1,"status":"pending","prd":"PRD-025"},
  {"id":"AAG-078","name":"Seed default daily caps","description":"INSERT default caps: dm_instagram=20, dm_twitter=50, dm_tiktok=30, dm_linkedin=50, comment_instagram=25, comment_twitter=40, comment_tiktok=25, comment_threads=30","category":"database","priority":1,"status":"pending","prd":"PRD-025"},
  {"id":"AAG-079","name":"AcquisitionOrchestrator.run_step() — execute a single agent","description":"Dispatch to correct agent by step name. Steps: 'discovery', 'scoring', 'warmup', 'outreach', 'sync', 'followup', 'report'. Wrap in try/except, log to acq_discovery_runs on error","category":"orchestrator","priority":1,"status":"pending","prd":"PRD-025"},
  {"id":"AAG-080","name":"Full pipeline run — orchestrator.run_all()","description":"Run all steps in order with guards. If daily cap hit for outreach step, skip gracefully. If any step fails, log and continue to next step (don't abort full pipeline)","category":"orchestrator","priority":1,"status":"pending","prd":"PRD-025"},
  {"id":"AAG-081","name":"Cron registration — 7 acquisition cron jobs","description":"Add all 7 acquisition crons to cron_definitions.py: discovery(6AM), scoring(7AM), warmup(8AM), outreach(9AM), sync(every4h), followup(10AM), report(Mon9AM). Gate all with ENABLE_ACQUISITION env flag","category":"orchestrator","priority":1,"status":"pending","prd":"PRD-025"},
  {"id":"AAG-082","name":"Workflow Engine DAG definition seed","description":"INSERT 'autonomous-acquisition' workflow definition into actp_workflow_definitions. 7-step DAG as specified in PRD-025. Seed via seed_acquisition_workflow.py script","category":"orchestrator","priority":2,"status":"pending","prd":"PRD-025"},
  {"id":"AAG-083","name":"Acquisition executor for actp-worker","description":"AcquisitionExecutor class in workflow_executors.py. task_types: acquisition_discovery, icp_scoring, engagement_warmup, dm_outreach, inbox_sync, followup_sequence, pipeline_report. Delegates to agent modules","category":"orchestrator","priority":2,"status":"pending","prd":"PRD-025"},
  {"id":"AAG-084","name":"Emergency pause/resume","description":"acq_orchestrator_state table (or env flag): ACQUISITION_PAUSED. Before any agent runs, check this flag. POST /api/acquisition/orchestrator/pause sets it. POST /api/acquisition/orchestrator/resume clears it","category":"orchestrator","priority":2,"status":"pending","prd":"PRD-025"},
  {"id":"AAG-085","name":"RetryHandler — exponential backoff for failed steps","description":"Failed steps: wait 5min, retry. Still failing: wait 15min, retry. Still failing: wait 1hr, retry. After 3 failures: mark step failed, notify human, continue pipeline with other steps","category":"orchestrator","priority":2,"status":"pending","prd":"PRD-025"},
  {"id":"AAG-086","name":"GET /api/acquisition/status — full dashboard endpoint","description":"Return pipeline stage counts, today's send/receive stats, daily cap usage per platform, agent last-run timestamps, overall health status. Sub-100ms response using pre-aggregated views","category":"api","priority":1,"status":"pending","prd":"PRD-025"},
  {"id":"AAG-087","name":"POST /api/acquisition/orchestrator/run endpoint","description":"Manually trigger a specific step. Accepts step name and dry_run flag. Blocks for up to 30s then returns result or run_id for polling","category":"api","priority":2,"status":"pending","prd":"PRD-025"},
  {"id":"AAG-088","name":"Supabase materialized view — pipeline_snapshot","description":"CREATE VIEW acq_pipeline_snapshot AS SELECT pipeline_stage, COUNT(*), AVG(relationship_score) FROM crm_contacts GROUP BY pipeline_stage. Used by status endpoint for fast reads","category":"database","priority":2,"status":"pending","prd":"PRD-025"},
  {"id":"AAG-089","name":"Orchestrator CLI — python3 acquisition/orchestrator.py","description":"CLI flags: --run-all, --step NAME, --status, --dry-run, --pause, --resume. Print formatted pipeline status table after each run","category":"setup","priority":2,"status":"pending","prd":"PRD-025"},
  {"id":"AAG-090","name":"Heartbeat integration — add acquisition to actp heartbeat","description":"In heartbeat_agent.py, add acquisition pipeline health check: pipeline stage counts, today's send stats, last agent run times, cap usage. Include in HEARTBEAT.md daily note","category":"integration","priority":2,"status":"pending","prd":"PRD-025"},
  {"id":"AAG-091","name":"ENABLE_ACQUISITION env flag — gate all crons","description":"All 7 acquisition crons check ENABLE_ACQUISITION env var before running. Default False. Set True in .env to activate. Add to env.example with documentation","category":"setup","priority":1,"status":"pending","prd":"PRD-025"},
  {"id":"AAG-092","name":"Orchestrator tests","description":"pytest: test_state_machine_valid_transitions, test_state_machine_invalid_raises, test_daily_cap_blocks_at_limit, test_daily_cap_resets_at_midnight, test_pause_blocks_all_steps, test_full_pipeline_continues_on_step_failure","category":"testing","priority":2,"status":"pending","prd":"PRD-025"},

  {"id":"AAG-093","name":"PipelineStatsCollector — aggregate CRM data for reports","description":"Query crm_contacts for stage counts. Query acq_funnel_events for this week's transitions. Query crm_messages for sent/received counts. Return WeeklyStats dataclass","category":"reporting","priority":1,"status":"pending","prd":"PRD-026"},
  {"id":"AAG-094","name":"ConversionCalculator — stage-to-stage rates","description":"Calculate: qualify_rate=(qualified/discovered), reply_rate=(replied/contacted), close_rate=(closed_won/replied). Compare to previous week. Flag improvements/regressions","category":"reporting","priority":1,"status":"pending","prd":"PRD-026"},
  {"id":"AAG-095","name":"NichePerformanceRanker — best niche × platform combos","description":"GROUP BY niche_label, platform FROM acq_funnel_events JOIN crm_contacts. Rank by reply_rate. Identify top 3 and bottom 3 combinations this week","category":"reporting","priority":2,"status":"pending","prd":"PRD-026"},
  {"id":"AAG-096","name":"InsightGenerator — Claude weekly insights","description":"Feed WeeklyStats to Claude (claude-3-5-sonnet). Prompt: generate 3-5 specific, actionable insights from this acquisition funnel data. Format as numbered list. Each insight has: observation, evidence, recommended_action","category":"reporting","priority":1,"status":"pending","prd":"PRD-026"},
  {"id":"AAG-097","name":"ReportFormatter — Markdown + HTML report","description":"Format WeeklyStats + insights into the report template from PRD-026. Render Markdown version (for Obsidian/email) and HTML version (for email delivery). Include comparison vs last week for key metrics","category":"reporting","priority":1,"status":"pending","prd":"PRD-026"},
  {"id":"AAG-098","name":"Report delivery — email","description":"Send HTML report via mcp0_mail_create_email. Subject: 'Acquisition Pipeline Report — Week of {date}'. Body: full HTML report. Save to acq_weekly_reports.delivered_at","category":"reporting","priority":1,"status":"pending","prd":"PRD-026"},
  {"id":"AAG-099","name":"Report delivery — Obsidian vault","description":"Write Markdown report to ~/.memory/vault/DAILY-NOTES/{YYYY-MM-DD}-acquisition-report.md. Append weekly summary to KNOWLEDGE-GRAPH.md under 'Acquisition' section","category":"reporting","priority":2,"status":"pending","prd":"PRD-026"},
  {"id":"AAG-100","name":"Report delivery — Apple push notification","description":"Send summary push via mcp0_notifications_send_notification: title='Weekly Acquisition Report', message='{replies} replies, {calls} calls booked this week. Top: {top_platform}'","category":"reporting","priority":2,"status":"pending","prd":"PRD-026"},
  {"id":"AAG-101","name":"VariantTracker — A/B message variant performance","description":"Group crm_messages by metadata.variant_id. Calculate reply_rate per variant. Store in acq_message_variants. Flag winner when one variant has 2x reply rate with >= 10 samples","category":"reporting","priority":2,"status":"pending","prd":"PRD-026"},
  {"id":"AAG-102","name":"Auto-apply insights — raise ICP min_score if data supports it","description":"If report insights include 'raise score threshold', call POST /api/acquisition/niches/{id} to UPDATE icp_min_score. Only auto-apply if confidence > 80% (sample size >= 20, delta >= 10 points)","category":"reporting","priority":3,"status":"pending","prd":"PRD-026"},
  {"id":"AAG-103","name":"GET /api/acquisition/reports/latest endpoint","description":"Return most recent weekly report: full stats, insights[], variant performance, top niche/platform, recommended actions. Include comparison to previous week","category":"api","priority":2,"status":"pending","prd":"PRD-026"},
  {"id":"AAG-104","name":"GET /api/acquisition/analytics/conversion endpoint","description":"Return conversion rates by stage with week-over-week delta. Accepts date_range filter","category":"api","priority":2,"status":"pending","prd":"PRD-026"},
  {"id":"AAG-105","name":"GET /api/acquisition/analytics/variants endpoint","description":"A/B variant performance table. Sends, replies, reply_rate per variant. Winner flag. Confidence score based on sample size","category":"api","priority":2,"status":"pending","prd":"PRD-026"},
  {"id":"AAG-106","name":"POST /api/acquisition/reports/generate endpoint","description":"Generate report for a given week_start date. Accepts deliver=true to also send email/push. Accepts dry_run=true to preview without saving","category":"api","priority":2,"status":"pending","prd":"PRD-026"},
  {"id":"AAG-107","name":"POST /api/acquisition/analytics/apply-insights endpoint","description":"Apply recommended actions from latest report: update ICP scores, mark best variant as default, update niche platform priorities. Returns applied_changes[]","category":"api","priority":3,"status":"pending","prd":"PRD-026"},
  {"id":"AAG-108","name":"Funnel event query helpers","description":"Helper functions: events_this_week(), conversion_between(from_stage, to_stage, since), avg_days_in_stage(stage). Used by all reporting queries","category":"database","priority":2,"status":"pending","prd":"PRD-026"},
  {"id":"AAG-109","name":"Reporting CLI — python3 acquisition/reporting_agent.py","description":"CLI flags: --generate (print report), --deliver (email + push + obsidian), --week DATE, --dry-run. Print formatted ASCII report to terminal","category":"setup","priority":2,"status":"pending","prd":"PRD-026"},
  {"id":"AAG-110","name":"Reporting tests","description":"pytest: test_stats_collector_counts_correctly, test_conversion_calculator, test_variant_tracker_identifies_winner, test_insight_generator_returns_actions, test_report_formatter_valid_markdown","category":"testing","priority":2,"status":"pending","prd":"PRD-026"},

  {"id":"AAG-111","name":"acquisition/config.py — centralized config","description":"All config in one place: SUPABASE_URL, SUPABASE_KEY, ANTHROPIC_API_KEY, DM_SERVICE_PORTS dict, COMMENT_SERVICE_PORTS dict, ENABLE_ACQUISITION, daily cap defaults, state machine transitions","category":"setup","priority":1,"status":"pending","prd":"PRD-025"},
  {"id":"AAG-112","name":"FastAPI server — acquisition/api/server.py","description":"FastAPI app with all acquisition routes mounted. Auth via API key header (X-API-Key). CORS configured. Health endpoint. Auto-generates OpenAPI docs at /docs","category":"api","priority":2,"status":"pending","prd":"PRD-025"},
  {"id":"AAG-113","name":"Pydantic schemas for all request/response models","description":"acquisition/api/schemas.py: NicheConfigCreate, NicheConfigUpdate, DiscoveryRunResult, WarmupStatus, OutreachRequest, OutreachResult, FollowUpResult, PipelineStatus, WeeklyReport schemas","category":"api","priority":2,"status":"pending","prd":"PRD-025"},
  {"id":"AAG-114","name":"acquisition/__init__.py — package exports","description":"Export main classes: AcquisitionOrchestrator, DiscoveryAgent, ScoringAgent, WarmupAgent, OutreachAgent, FollowUpAgent, ReportingAgent. Version: 1.0.0","category":"setup","priority":2,"status":"pending","prd":"PRD-025"},
  {"id":"AAG-115","name":"Dockerfile for acquisition service","description":"Python 3.11 slim base. Install requirements. EXPOSE 8080. CMD uvicorn acquisition.api.server:app. Add to docker-compose.yml","category":"setup","priority":3,"status":"pending","prd":"PRD-025"},
  {"id":"AAG-116","name":"requirements.txt for acquisition module","description":"Dependencies: anthropic, httpx, supabase, fastapi, uvicorn, pydantic, python-dotenv, apscheduler (or use existing crm_brain pattern). Pin versions","category":"setup","priority":1,"status":"pending","prd":"PRD-025"},
  {"id":"AAG-117","name":"End-to-end integration test — full pipeline dry run","description":"test_e2e_acquisition_pipeline.py: seed 3 test contacts, run full pipeline with dry_run=True, verify each stage transition, verify no DMs sent, verify all DB records created correctly","category":"testing","priority":1,"status":"pending","prd":"PRD-025"},
  {"id":"AAG-118","name":"Rate limit recovery — retry tomorrow on cap hit","description":"When a contact's DM is skipped due to daily cap, UPDATE acq_outreach_sequences.scheduled_at = tomorrow 9AM. Contact stays in pipeline, not archived","category":"agent","priority":2,"status":"pending","prd":"PRD-025"},
  {"id":"AAG-119","name":"Acquisition dashboard endpoint — GET /api/acquisition/dashboard","description":"Comprehensive single-call dashboard: pipeline snapshot + today stats + agent health + latest report summary + cap usage. Designed for a future web UI to render in one request","category":"api","priority":3,"status":"pending","prd":"PRD-026"},
  {"id":"AAG-120","name":"README.md for acquisition module","description":"Document: overview, architecture diagram, setup instructions, environment variables, CLI commands, cron schedule, how to configure niches, how to interpret reports. With example output","category":"setup","priority":2,"status":"pending","prd":"PRD-025"}
]
