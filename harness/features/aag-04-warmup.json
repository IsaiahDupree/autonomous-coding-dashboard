{"features":[
  {"id":"AAG-031","name":"WarmupConfig model + defaults","description":"Pydantic model and Supabase table for acq_warmup_configs. Default: 2 comments over 5 days, min 20h gap, AI comments enabled, tone=insightful. One config per niche","category":"database","priority":1,"status":"completed","passes":true,"prd":"PRD-023"},
  {"id":"AAG-032","name":"PostFetcher — get prospect's recent posts for warmup context","description":"First check crm_market_research for cached posts. If none or stale (>7 days), call Market Research API for 3 most recent posts. Return PostData list sorted by engagement desc","category":"agent","priority":1,"status":"completed","passes":true,"prd":"PRD-023"},
  {"id":"AAG-033","name":"CommentGenerator — Claude-powered per-post comments","description":"For each post, call Claude (claude-3-haiku) with post text + niche context. Generate 1-2 sentence insightful comment. Validate: not generic, references specific content, no pitch. Retry once if validation fails","category":"agent","priority":1,"status":"completed","passes":true,"prd":"PRD-023"},
  {"id":"AAG-034","name":"WarmupScheduler — schedule N comments over window_days","description":"Given a qualified contact and warmup config, create acq_warmup_schedules rows. Spread comments across window_days with randomized times (8AM–6PM). Never same-day as another comment to same contact","category":"agent","priority":1,"status":"completed","passes":true,"prd":"PRD-023"},
  {"id":"AAG-035","name":"Warmup batch scheduler — process all newly-qualified contacts","description":"Read crm_contacts WHERE pipeline_stage='qualified' AND id NOT IN (SELECT contact_id FROM acq_warmup_schedules). Create warmup schedules for all. UPDATE pipeline_stage='warming'","category":"agent","priority":1,"status":"completed","passes":true,"prd":"PRD-023"},
  {"id":"AAG-036","name":"CommentSender — send scheduled warmup comments","description":"Read acq_warmup_schedules WHERE status='pending' AND scheduled_at <= NOW(). For each, call correct comment service endpoint. Update status='sent', comment_id, sent_at. Handle failures gracefully","category":"agent","priority":1,"status":"completed","passes":true,"prd":"PRD-023"},
  {"id":"AAG-037","name":"Platform comment endpoint routing","description":"Map platform → comment service: instagram→3005 /api/instagram/comments/post, twitter→3007 /api/twitter/comments/post (useAI:false, text provided), tiktok→3006, threads→3004","category":"integration","priority":1,"status":"completed","passes":true,"prd":"PRD-023"},
  {"id":"AAG-038","name":"CommentRateLimiter — max N comments per platform per day","description":"Before sending any comment, check acq_daily_caps for comments action + platform. If at limit, skip and reschedule to tomorrow. Default caps: IG=25, TW=40, TT=25, Threads=30","category":"agent","priority":1,"status":"completed","passes":true,"prd":"PRD-023"},
  {"id":"AAG-039","name":"Duplicate post guard — never comment twice on same post","description":"Before scheduling, check acq_warmup_schedules WHERE contact_id=$1 AND post_url=$2. Skip post if already scheduled or sent. Select next best post from PostFetcher result","category":"agent","priority":1,"status":"completed","passes":true,"prd":"PRD-023"},
  {"id":"AAG-040","name":"Warmup completion detection + stage advance","description":"After each comment send, check: does this contact now have >= warmup_target comments sent? If yes, UPDATE crm_contacts SET pipeline_stage='ready_for_dm'. INSERT acq_funnel_events","category":"agent","priority":1,"status":"completed","passes":true,"prd":"PRD-023"},
  {"id":"AAG-041","name":"Warmup window timeout — advance even if target not met","description":"If warmup window_days have elapsed but comment target not met (failed sends), advance to ready_for_dm anyway with skip_warmup=true flag. Log reason in acq_funnel_events.metadata","category":"agent","priority":2,"status":"completed","passes":true,"prd":"PRD-023"},
  {"id":"AAG-042","name":"crm_messages write after every sent warmup comment","description":"INSERT to crm_messages: platform, username=post_url, message_text=comment_text, message_type='comment', is_outbound=true, sent_by_automation=true, metadata={commentId, postUrl, warmup=true}","category":"integration","priority":1,"status":"completed","passes":true,"prd":"PRD-023"},
  {"id":"AAG-043","name":"POST /api/acquisition/warmup/schedule endpoint","description":"Schedule warmup for a batch of contact_ids. Accepts optional override_config. Returns scheduled_count, posts_found, errors","category":"api","priority":2,"status":"completed","passes":true,"prd":"PRD-023"},
  {"id":"AAG-044","name":"POST /api/acquisition/warmup/execute endpoint","description":"Execute pending warmup comments. Accepts platform filter, limit. Returns sent_count, skipped_count, failed_count. Called by cron","category":"api","priority":2,"status":"completed","passes":true,"prd":"PRD-023"},
  {"id":"AAG-045","name":"GET /api/acquisition/warmup/status endpoint","description":"Return warmup pipeline status: pending schedule count, sent today per platform, contacts currently warming, contacts ready_for_dm, completion rate","category":"api","priority":2,"status":"completed","passes":true,"prd":"PRD-023"},
  {"id":"AAG-046","name":"Warmup CLI — python3 acquisition/warmup_agent.py","description":"CLI flags: --schedule (process qualified contacts), --execute (send pending), --status, --dry-run, --platform. Print per-platform counts","category":"setup","priority":2,"status":"completed","passes":true,"prd":"PRD-023"},
  {"id":"AAG-047","name":"Warmup tests","description":"pytest: test_comment_generator_not_generic, test_schedule_spreads_over_window, test_duplicate_post_guard, test_rate_limit_enforcement, test_stage_advance_on_completion, test_window_timeout_advance","category":"testing","priority":2,"status":"completed","passes":true,"prd":"PRD-023"},
  {"id":"AAG-048","name":"Warmup config per niche — different tone per service","description":"LinkedIn niche: tone=professional, 2 comments. Creator niche: tone=encouraging, 3 comments. AI tools niche: tone=curious. Stored in acq_warmup_configs linked to niche_config_id","category":"setup","priority":3,"status":"completed","passes":true,"prd":"PRD-023"},
  {"id":"AAG-049","name":"Warmup analytics — comment to DM reply rate correlation","description":"Track: did contacts who received 3 warmup comments reply to DM at higher rate than 0 or 1? Log correlation in acq_weekly_reports.insights for human review","category":"reporting","priority":3,"status":"completed","passes":true,"prd":"PRD-023"},
  {"id":"AAG-050","name":"Warmup skip option for high-score contacts","description":"If contact ICP score >= 85, skip warmup entirely and advance directly to ready_for_dm. Configurable threshold in acq_niche_configs.skip_warmup_min_score","category":"agent","priority":3,"status":"completed","passes":true,"prd":"PRD-023"}
]}
