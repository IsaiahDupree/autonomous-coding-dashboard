{
  "project": "CanvasCast",
  "description": "AI Video Generation Platform - Transform text prompts into fully produced short-form videos with AI-generated scripts, voiceover, images, and captions",
  "version": "1.0",
  "totalFeatures": 177,
  "completedFeatures": 177,
  "phases": {
    "phase1_foundation": "Project setup, monorepo structure, shared packages",
    "phase2_database": "Supabase schema, migrations, RLS policies, RPC functions",
    "phase3_auth": "Authentication flows, magic links, OAuth, session management",
    "phase4_draft": "Pre-auth prompt capture and restoration",
    "phase5_api": "Express API server, job creation, credit endpoints",
    "phase6_worker": "BullMQ worker, pipeline orchestration",
    "phase7_pipeline_steps": "9-step video generation pipeline",
    "phase8_frontend": "Next.js UI, pages, components",
    "phase9_billing": "Stripe integration, credits, subscriptions",
    "phase10_email": "Transactional email notifications",
    "phase11_storage": "Asset storage, CDN, file lifecycle",
    "phase12_testing": "Unit, integration, E2E tests",
    "phase13_resilience": "Error recovery, retries, dead letter queue",
    "phase14_moderation": "Content moderation and safety",
    "phase15_analytics": "PostHog analytics and metrics",
    "phase16_admin": "Admin dashboard and tooling",
    "phase17_documents": "PDF/DOCX extraction and file processing",
    "phase18_remotion_prod": "Remotion Lambda and production templates",
    "phase19_rate_limiting": "Rate limiting and abuse prevention",
    "phase20_gdpr": "Data retention, GDPR, privacy compliance",
    "phase21_a11y": "Accessibility and WCAG compliance"
  },
  "features": [
    {
      "id": "FOUND-001",
      "name": "Monorepo Setup",
      "description": "Initialize pnpm workspace with apps/web, apps/api, apps/worker, packages/shared, packages/remotion",
      "priority": "P0",
      "phase": 1,
      "effort": "2h",
      "passes": true,
      "category": "foundation",
      "files": [
        "pnpm-workspace.yaml",
        "package.json",
        "turbo.json"
      ],
      "acceptance": [
        "pnpm install works",
        "All workspaces linked",
        "turbo dev runs all apps"
      ]
    },
    {
      "id": "FOUND-002",
      "name": "Shared Types Package",
      "description": "Create packages/shared with TypeScript types for all subsystems",
      "priority": "P0",
      "phase": 1,
      "effort": "4h",
      "passes": true,
      "category": "foundation",
      "files": [
        "packages/shared/src/types/index.ts",
        "packages/shared/src/types/job.ts",
        "packages/shared/src/types/project.ts"
      ],
      "acceptance": [
        "Types exported correctly",
        "All apps can import types"
      ]
    },
    {
      "id": "FOUND-003",
      "name": "Shared Schemas Package",
      "description": "Create Zod schemas for validation in packages/shared",
      "priority": "P0",
      "phase": 1,
      "effort": "4h",
      "passes": true,
      "category": "foundation",
      "files": [
        "packages/shared/src/schemas/project.ts",
        "packages/shared/src/schemas/job.ts"
      ],
      "acceptance": [
        "Schemas validate correctly",
        "API uses schemas for validation"
      ]
    },
    {
      "id": "FOUND-004",
      "name": "Environment Configuration",
      "description": "Setup .env.example files for all apps with required variables",
      "priority": "P0",
      "phase": 1,
      "effort": "1h",
      "passes": true,
      "category": "foundation",
      "files": [
        "apps/web/.env.example",
        "apps/api/.env.example",
        "apps/worker/.env.example"
      ],
      "acceptance": [
        "All env vars documented",
        "Apps fail gracefully on missing vars"
      ]
    },
    {
      "id": "FOUND-005",
      "name": "Remotion Package Setup",
      "description": "Initialize packages/remotion with video composition structure",
      "priority": "P0",
      "phase": 1,
      "effort": "4h",
      "passes": true,
      "category": "foundation",
      "files": [
        "packages/remotion/src/index.ts",
        "packages/remotion/src/compositions/Main.tsx"
      ],
      "acceptance": [
        "Remotion preview works",
        "Composition renders test video"
      ]
    },
    {
      "id": "DB-001",
      "name": "Profiles Table Migration",
      "description": "Create profiles table linked to auth.users",
      "priority": "P0",
      "phase": 2,
      "effort": "1h",
      "passes": true,
      "category": "database",
      "files": [
        "supabase/migrations/20260118000001_profiles.sql"
      ],
      "acceptance": [
        "Table created",
        "FK to auth.users",
        "RLS policies applied"
      ]
    },
    {
      "id": "DB-002",
      "name": "Projects Table Migration",
      "description": "Create projects table for video projects",
      "priority": "P0",
      "phase": 2,
      "effort": "1h",
      "passes": true,
      "category": "database",
      "files": [
        "supabase/migrations/20260118000002_projects.sql"
      ],
      "acceptance": [
        "Table created",
        "FK to profiles",
        "RLS policies applied"
      ]
    },
    {
      "id": "DB-003",
      "name": "Jobs Table Migration",
      "description": "Create jobs table for pipeline jobs with status enum",
      "priority": "P0",
      "phase": 2,
      "effort": "2h",
      "passes": true,
      "category": "database",
      "files": [
        "supabase/migrations/20260118000003_jobs.sql"
      ],
      "acceptance": [
        "Table created",
        "job_status enum works",
        "Progress tracking columns"
      ]
    },
    {
      "id": "DB-004",
      "name": "Job Steps Table Migration",
      "description": "Create job_steps table for per-step tracking",
      "priority": "P0",
      "phase": 2,
      "effort": "1h",
      "passes": true,
      "category": "database",
      "files": [
        "supabase/migrations/20260118000000_draft_prompts_job_steps.sql"
      ],
      "acceptance": [
        "Table created",
        "FK to jobs",
        "Step state enum works"
      ]
    },
    {
      "id": "DB-005",
      "name": "Draft Prompts Table Migration",
      "description": "Create draft_prompts table for pre-auth prompt capture",
      "priority": "P0",
      "phase": 2,
      "effort": "1h",
      "passes": true,
      "category": "database",
      "files": [
        "supabase/migrations/20260118000005_draft_prompts.sql"
      ],
      "acceptance": [
        "Table created",
        "Session token indexed",
        "Expiry works"
      ]
    },
    {
      "id": "DB-006",
      "name": "Credit Ledger Table Migration",
      "description": "Create credit_ledger table for credit transactions",
      "priority": "P0",
      "phase": 2,
      "effort": "2h",
      "passes": true,
      "category": "database",
      "files": [
        "supabase/migrations/20260118000006_credit_ledger.sql"
      ],
      "acceptance": [
        "Table created",
        "Balance calculation works",
        "Transaction types enum"
      ]
    },
    {
      "id": "DB-007",
      "name": "Subscriptions Table Migration",
      "description": "Create subscriptions table for Stripe subscriptions",
      "priority": "P0",
      "phase": 2,
      "effort": "1h",
      "passes": true,
      "category": "database",
      "files": [
        "supabase/migrations/20260118000007_subscriptions.sql"
      ],
      "acceptance": [
        "Table created",
        "Stripe IDs indexed",
        "Status tracking works"
      ]
    },
    {
      "id": "DB-008",
      "name": "Assets Table Migration",
      "description": "Create assets table for generated video assets",
      "priority": "P0",
      "phase": 2,
      "effort": "1h",
      "passes": true,
      "category": "database",
      "files": [
        "supabase/migrations/20260118000008_assets.sql"
      ],
      "acceptance": [
        "Table created",
        "FK to jobs",
        "Asset types enum works"
      ]
    },
    {
      "id": "DB-009",
      "name": "Handle New User Trigger",
      "description": "Create trigger to create profile and grant trial credits on signup",
      "priority": "P0",
      "phase": 2,
      "effort": "2h",
      "passes": true,
      "category": "database",
      "files": [
        "supabase/migrations/20260118000009_handle_new_user.sql"
      ],
      "acceptance": [
        "Trigger fires on auth.users INSERT",
        "Profile created",
        "10 trial credits granted"
      ]
    },
    {
      "id": "DB-010",
      "name": "Credit Balance RPC Function",
      "description": "Create get_credit_balance RPC function",
      "priority": "P0",
      "phase": 2,
      "effort": "1h",
      "passes": true,
      "category": "database",
      "files": [
        "supabase/migrations/20260118000010_credit_functions.sql"
      ],
      "acceptance": [
        "Function returns correct balance",
        "Handles null case"
      ]
    },
    {
      "id": "DB-011",
      "name": "Reserve Credits RPC Function",
      "description": "Create reserve_credits RPC function for job start",
      "priority": "P0",
      "phase": 2,
      "effort": "1h",
      "passes": true,
      "category": "database",
      "files": [
        "supabase/migrations/20260118000010_credit_functions.sql"
      ],
      "acceptance": [
        "Function reserves credits",
        "Returns false if insufficient"
      ]
    },
    {
      "id": "DB-012",
      "name": "Finalize Job Credits RPC Function",
      "description": "Create finalize_job_credits RPC function for job completion",
      "priority": "P0",
      "phase": 2,
      "effort": "1h",
      "passes": true,
      "category": "database",
      "files": [
        "supabase/migrations/20260118000010_credit_functions.sql"
      ],
      "acceptance": [
        "Function finalizes credits",
        "Refunds difference if needed"
      ]
    },
    {
      "id": "DB-013",
      "name": "Release Job Credits RPC Function",
      "description": "Create release_job_credits RPC function for job failure",
      "priority": "P0",
      "phase": 2,
      "effort": "1h",
      "passes": true,
      "category": "database",
      "files": [
        "supabase/migrations/20260118000010_credit_functions.sql"
      ],
      "acceptance": [
        "Function releases reserved credits",
        "Logs refund transaction"
      ]
    },
    {
      "id": "DB-014",
      "name": "Claim Draft Prompt RPC Function",
      "description": "Create claim_draft_prompt RPC function for post-auth draft claim",
      "priority": "P0",
      "phase": 2,
      "effort": "1h",
      "passes": true,
      "category": "database",
      "files": [
        "supabase/migrations/20260118000011_draft_functions.sql"
      ],
      "acceptance": [
        "Function claims draft",
        "Links to user_id",
        "Returns draft or null"
      ]
    },
    {
      "id": "DB-015",
      "name": "Cleanup Expired Drafts Function",
      "description": "Create cleanup_expired_drafts function for housekeeping",
      "priority": "P1",
      "phase": 2,
      "effort": "1h",
      "passes": true,
      "category": "database",
      "files": [
        "supabase/migrations/20260118000011_draft_functions.sql"
      ],
      "acceptance": [
        "Function deletes expired unclaimed drafts",
        "Returns count"
      ]
    },
    {
      "id": "AUTH-001",
      "name": "Supabase Client Setup",
      "description": "Create Supabase browser and server clients",
      "priority": "P0",
      "phase": 3,
      "effort": "2h",
      "passes": true,
      "category": "auth",
      "files": [
        "apps/web/src/lib/supabase/client.ts",
        "apps/web/src/lib/supabase/server.ts"
      ],
      "acceptance": [
        "Browser client works",
        "Server client works",
        "Types generated"
      ]
    },
    {
      "id": "AUTH-002",
      "name": "Auth Middleware",
      "description": "Create Next.js middleware for protected routes",
      "priority": "P0",
      "phase": 3,
      "effort": "2h",
      "passes": true,
      "category": "auth",
      "files": [
        "apps/web/src/middleware.ts"
      ],
      "acceptance": [
        "Redirects unauthenticated users",
        "Allows public routes",
        "Refreshes session"
      ]
    },
    {
      "id": "AUTH-003",
      "name": "Signup Page",
      "description": "Create signup page with email and Google OAuth",
      "priority": "P0",
      "phase": 3,
      "effort": "4h",
      "passes": true,
      "category": "auth",
      "files": [
        "apps/web/src/app/signup/page.tsx"
      ],
      "acceptance": [
        "Email magic link works",
        "Google OAuth works",
        "Draft param preserved"
      ]
    },
    {
      "id": "AUTH-004",
      "name": "Login Page",
      "description": "Create login page with email and Google OAuth",
      "priority": "P0",
      "phase": 3,
      "effort": "2h",
      "passes": true,
      "category": "auth",
      "files": [
        "apps/web/src/app/login/page.tsx"
      ],
      "acceptance": [
        "Email magic link works",
        "Google OAuth works",
        "Redirect to /app"
      ]
    },
    {
      "id": "AUTH-005",
      "name": "Auth Callback Handler",
      "description": "Create OAuth callback route handler",
      "priority": "P0",
      "phase": 3,
      "effort": "2h",
      "passes": true,
      "category": "auth",
      "files": [
        "apps/web/src/app/auth/callback/route.ts"
      ],
      "acceptance": [
        "Exchanges code for session",
        "Claims pending draft",
        "Redirects correctly"
      ]
    },
    {
      "id": "AUTH-006",
      "name": "Signout Route",
      "description": "Create signout API route",
      "priority": "P0",
      "phase": 3,
      "effort": "1h",
      "passes": true,
      "category": "auth",
      "files": [
        "apps/web/src/app/api/auth/signout/route.ts"
      ],
      "acceptance": [
        "Clears session",
        "Redirects to landing"
      ]
    },
    {
      "id": "AUTH-007",
      "name": "useAuth Hook",
      "description": "Create useAuth hook for auth state management",
      "priority": "P0",
      "phase": 3,
      "effort": "2h",
      "passes": true,
      "category": "auth",
      "files": [
        "apps/web/src/hooks/useAuth.ts"
      ],
      "acceptance": [
        "Returns user state",
        "Handles loading",
        "Subscribes to auth changes"
      ]
    },
    {
      "id": "AUTH-008",
      "name": "Auth Provider",
      "description": "Create AuthProvider context wrapper",
      "priority": "P0",
      "phase": 3,
      "effort": "1h",
      "passes": true,
      "category": "auth",
      "files": [
        "apps/web/src/providers/AuthProvider.tsx"
      ],
      "acceptance": [
        "Provides auth context",
        "Wraps app"
      ]
    },
    {
      "id": "DRAFT-001",
      "name": "Create Draft API Route",
      "description": "POST /api/draft endpoint for saving prompts",
      "priority": "P0",
      "phase": 4,
      "effort": "3h",
      "passes": true,
      "category": "draft",
      "files": [
        "apps/web/src/app/api/draft/route.ts"
      ],
      "acceptance": [
        "Creates draft in DB",
        "Sets session cookie",
        "Returns draftId"
      ]
    },
    {
      "id": "DRAFT-002",
      "name": "Get Draft API Route",
      "description": "GET /api/draft endpoint for retrieving prompts",
      "priority": "P0",
      "phase": 4,
      "effort": "2h",
      "passes": true,
      "category": "draft",
      "files": [
        "apps/web/src/app/api/draft/route.ts"
      ],
      "acceptance": [
        "Returns draft by session token",
        "Returns claimed draft by user_id"
      ]
    },
    {
      "id": "DRAFT-003",
      "name": "Prompt Input Component",
      "description": "Landing page prompt input with draft saving",
      "priority": "P0",
      "phase": 4,
      "effort": "3h",
      "passes": true,
      "category": "draft",
      "files": [
        "apps/web/src/components/prompt-input.tsx"
      ],
      "acceptance": [
        "Textarea with validation",
        "Saves draft on submit",
        "Redirects to signup"
      ]
    },
    {
      "id": "API-001",
      "name": "Express API Server Setup",
      "description": "Initialize Express server with middleware",
      "priority": "P0",
      "phase": 5,
      "effort": "3h",
      "passes": true,
      "category": "api",
      "files": [
        "apps/api/src/index.ts",
        "apps/api/src/middleware/auth.ts"
      ],
      "acceptance": [
        "Server starts on port 8989",
        "Auth middleware works",
        "CORS configured"
      ]
    },
    {
      "id": "API-002",
      "name": "Redis Client Setup",
      "description": "Create Redis/BullMQ connection",
      "priority": "P0",
      "phase": 5,
      "effort": "1h",
      "passes": true,
      "category": "api",
      "files": [
        "apps/api/src/lib/redis.ts",
        "apps/api/src/lib/queue.ts"
      ],
      "acceptance": [
        "Redis connects",
        "BullMQ queue created"
      ]
    },
    {
      "id": "API-003",
      "name": "Create Project Endpoint",
      "description": "POST /api/v1/projects endpoint",
      "priority": "P0",
      "phase": 5,
      "effort": "4h",
      "passes": true,
      "category": "api",
      "files": [
        "apps/api/src/index.ts"
      ],
      "acceptance": [
        "Validates input",
        "Checks credits",
        "Creates project and job",
        "Queues job"
      ]
    },
    {
      "id": "API-004",
      "name": "Get Project Endpoint",
      "description": "GET /api/v1/projects/:id endpoint",
      "priority": "P0",
      "phase": 5,
      "effort": "2h",
      "passes": true,
      "category": "api",
      "files": [
        "apps/api/src/index.ts"
      ],
      "acceptance": [
        "Returns project with job status",
        "Checks ownership"
      ]
    },
    {
      "id": "API-005",
      "name": "List Projects Endpoint",
      "description": "GET /api/v1/projects endpoint with pagination",
      "priority": "P0",
      "phase": 5,
      "effort": "2h",
      "passes": true,
      "category": "api",
      "files": [
        "apps/api/src/index.ts"
      ],
      "acceptance": [
        "Returns paginated projects",
        "Filters by user"
      ]
    },
    {
      "id": "API-006",
      "name": "Job Status Endpoint",
      "description": "GET /api/v1/jobs/:id/status endpoint",
      "priority": "P0",
      "phase": 5,
      "effort": "2h",
      "passes": true,
      "category": "api",
      "files": [
        "apps/api/src/index.ts"
      ],
      "acceptance": [
        "Returns job status and progress",
        "Returns step details"
      ]
    },
    {
      "id": "API-007",
      "name": "Credit Balance Endpoint",
      "description": "GET /api/v1/credits/balance endpoint",
      "priority": "P0",
      "phase": 5,
      "effort": "1h",
      "passes": true,
      "category": "api",
      "files": [
        "apps/api/src/index.ts"
      ],
      "acceptance": [
        "Returns balance, reserved, available"
      ]
    },
    {
      "id": "API-008",
      "name": "Credit History Endpoint",
      "description": "GET /api/v1/credits/history endpoint",
      "priority": "P1",
      "phase": 5,
      "effort": "2h",
      "passes": true,
      "category": "api",
      "files": [
        "apps/api/src/index.ts"
      ],
      "acceptance": [
        "Returns transaction history",
        "Paginated"
      ]
    },
    {
      "id": "API-009",
      "name": "Purchase Credits Endpoint",
      "description": "POST /api/v1/credits/purchase endpoint",
      "priority": "P0",
      "phase": 5,
      "effort": "3h",
      "passes": true,
      "category": "api",
      "files": [
        "apps/api/src/index.ts"
      ],
      "acceptance": [
        "Creates Stripe checkout session",
        "Returns checkout URL"
      ]
    },
    {
      "id": "API-010",
      "name": "Create Subscription Endpoint",
      "description": "POST /api/v1/subscriptions endpoint",
      "priority": "P1",
      "phase": 5,
      "effort": "3h",
      "passes": true,
      "category": "api",
      "files": [
        "apps/api/src/index.ts"
      ],
      "acceptance": [
        "Creates Stripe subscription checkout",
        "Returns checkout URL"
      ]
    },
    {
      "id": "API-011",
      "name": "Cancel Subscription Endpoint",
      "description": "POST /api/v1/subscriptions/cancel endpoint",
      "priority": "P1",
      "phase": 5,
      "effort": "2h",
      "passes": true,
      "category": "api",
      "files": [
        "apps/api/src/index.ts"
      ],
      "acceptance": [
        "Cancels at period end",
        "Updates subscription record"
      ]
    },
    {
      "id": "API-012",
      "name": "Stripe Webhook Handler",
      "description": "POST /api/webhooks/stripe endpoint",
      "priority": "P0",
      "phase": 5,
      "effort": "4h",
      "passes": true,
      "category": "api",
      "files": [
        "apps/api/src/index.ts"
      ],
      "acceptance": [
        "Verifies Stripe signature",
        "Handles checkout.session.completed",
        "Handles invoice.paid"
      ]
    },
    {
      "id": "API-013",
      "name": "Health Check Endpoint",
      "description": "GET /health and /ready endpoints",
      "priority": "P0",
      "phase": 5,
      "effort": "1h",
      "passes": true,
      "category": "api",
      "files": [
        "apps/api/src/index.ts"
      ],
      "acceptance": [
        "Returns status",
        "Checks Redis and DB connections"
      ]
    },
    {
      "id": "WORKER-001",
      "name": "Worker Entry Point",
      "description": "Initialize BullMQ worker process",
      "priority": "P0",
      "phase": 6,
      "effort": "3h",
      "passes": true,
      "category": "worker",
      "files": [
        "apps/worker/src/index.ts",
        "apps/worker/src/worker.ts"
      ],
      "acceptance": [
        "Connects to Redis",
        "Processes jobs from queue"
      ]
    },
    {
      "id": "WORKER-002",
      "name": "Pipeline Runner",
      "description": "Create pipeline orchestrator with step execution",
      "priority": "P0",
      "phase": 6,
      "effort": "4h",
      "passes": true,
      "category": "worker",
      "files": [
        "apps/worker/src/pipeline/runner.ts"
      ],
      "acceptance": [
        "Runs steps in order",
        "Updates job status",
        "Handles failures"
      ]
    },
    {
      "id": "WORKER-003",
      "name": "Pipeline Context",
      "description": "Create pipeline context and artifact management",
      "priority": "P0",
      "phase": 6,
      "effort": "2h",
      "passes": true,
      "category": "worker",
      "files": [
        "apps/worker/src/pipeline/types.ts",
        "apps/worker/src/pipeline/context.ts"
      ],
      "acceptance": [
        "Context passed between steps",
        "Artifacts accumulated"
      ]
    },
    {
      "id": "WORKER-004",
      "name": "Worker Health Check",
      "description": "Add health check endpoint to worker",
      "priority": "P1",
      "phase": 6,
      "effort": "1h",
      "passes": true,
      "category": "worker",
      "files": [
        "apps/worker/src/health.ts"
      ],
      "acceptance": [
        "Returns worker status",
        "Reports queue depth"
      ]
    },
    {
      "id": "PIPE-001",
      "name": "Script Generation Step",
      "description": "Generate video script using LLM (GPT-4)",
      "priority": "P0",
      "phase": 7,
      "effort": "6h",
      "passes": true,
      "category": "pipeline",
      "files": [
        "apps/worker/src/pipeline/steps/generate-script.ts"
      ],
      "acceptance": [
        "Calls OpenAI API",
        "Returns structured script",
        "Handles niche presets"
      ]
    },
    {
      "id": "PIPE-002",
      "name": "Voice Generation Step",
      "description": "Generate TTS narration using OpenAI TTS",
      "priority": "P0",
      "phase": 7,
      "effort": "4h",
      "passes": true,
      "category": "pipeline",
      "files": [
        "apps/worker/src/pipeline/steps/generate-voice.ts"
      ],
      "acceptance": [
        "Calls OpenAI TTS API",
        "Saves MP3 file",
        "Returns duration"
      ]
    },
    {
      "id": "PIPE-003",
      "name": "Alignment Step",
      "description": "Extract word-level timestamps using Whisper",
      "priority": "P0",
      "phase": 7,
      "effort": "4h",
      "passes": true,
      "category": "pipeline",
      "files": [
        "apps/worker/src/pipeline/steps/run-alignment.ts"
      ],
      "acceptance": [
        "Calls Whisper API",
        "Returns word segments",
        "Generates SRT/VTT"
      ]
    },
    {
      "id": "PIPE-004",
      "name": "Visual Plan Step",
      "description": "Plan scene layout and image prompts",
      "priority": "P0",
      "phase": 7,
      "effort": "3h",
      "passes": true,
      "category": "pipeline",
      "files": [
        "apps/worker/src/pipeline/steps/plan-visuals.ts"
      ],
      "acceptance": [
        "Maps scenes to timestamps",
        "Generates image prompts"
      ]
    },
    {
      "id": "PIPE-005",
      "name": "Image Generation Step",
      "description": "Generate images using Gemini Imagen",
      "priority": "P0",
      "phase": 7,
      "effort": "6h",
      "passes": true,
      "category": "pipeline",
      "files": [
        "apps/worker/src/pipeline/steps/generate-images.ts"
      ],
      "acceptance": [
        "Calls Gemini API",
        "Saves images",
        "Handles rate limits"
      ]
    },
    {
      "id": "PIPE-006",
      "name": "Timeline Build Step",
      "description": "Create Remotion timeline data",
      "priority": "P0",
      "phase": 7,
      "effort": "4h",
      "passes": true,
      "category": "pipeline",
      "files": [
        "apps/worker/src/pipeline/steps/build-timeline.ts"
      ],
      "acceptance": [
        "Creates timeline JSON",
        "Maps images to segments"
      ]
    },
    {
      "id": "PIPE-007",
      "name": "Video Rendering Step",
      "description": "Render video using Remotion",
      "priority": "P0",
      "phase": 7,
      "effort": "8h",
      "passes": true,
      "category": "pipeline",
      "files": [
        "apps/worker/src/pipeline/steps/render-video.ts"
      ],
      "acceptance": [
        "Calls Remotion render",
        "Outputs MP4",
        "Reports progress"
      ]
    },
    {
      "id": "PIPE-008",
      "name": "Asset Packaging Step",
      "description": "Bundle and upload all assets",
      "priority": "P0",
      "phase": 7,
      "effort": "4h",
      "passes": true,
      "category": "pipeline",
      "files": [
        "apps/worker/src/pipeline/steps/package-assets.ts"
      ],
      "acceptance": [
        "Uploads to storage",
        "Creates ZIP",
        "Records in assets table"
      ]
    },
    {
      "id": "PIPE-009",
      "name": "Notify Complete Step",
      "description": "Send completion notification and finalize credits",
      "priority": "P0",
      "phase": 7,
      "effort": "2h",
      "passes": true,
      "category": "pipeline",
      "files": [
        "apps/worker/src/pipeline/steps/notify-complete.ts"
      ],
      "acceptance": [
        "Finalizes credits",
        "Queues email notification"
      ]
    },
    {
      "id": "REMOTION-001",
      "name": "Main Video Composition",
      "description": "Create main Remotion composition component",
      "priority": "P0",
      "phase": 7,
      "effort": "6h",
      "passes": true,
      "category": "remotion",
      "files": [
        "packages/remotion/src/compositions/Main.tsx"
      ],
      "acceptance": [
        "Renders video with images",
        "Syncs audio",
        "Shows captions"
      ]
    },
    {
      "id": "REMOTION-002",
      "name": "Caption Component",
      "description": "Create animated caption component",
      "priority": "P0",
      "phase": 7,
      "effort": "4h",
      "passes": true,
      "category": "remotion",
      "files": [
        "packages/remotion/src/components/Caption.tsx"
      ],
      "acceptance": [
        "Highlights current word",
        "Animates smoothly"
      ]
    },
    {
      "id": "REMOTION-003",
      "name": "Scene Component",
      "description": "Create scene/image display component",
      "priority": "P0",
      "phase": 7,
      "effort": "3h",
      "passes": true,
      "category": "remotion",
      "files": [
        "packages/remotion/src/components/Scene.tsx"
      ],
      "acceptance": [
        "Ken Burns effect",
        "Smooth transitions"
      ]
    },
    {
      "id": "REMOTION-004",
      "name": "Render Entry Point",
      "description": "Create render entry point for Node.js",
      "priority": "P0",
      "phase": 7,
      "effort": "2h",
      "passes": true,
      "category": "remotion",
      "files": [
        "packages/remotion/src/render.ts"
      ],
      "acceptance": [
        "Called from worker",
        "Returns output path"
      ]
    },
    {
      "id": "UI-001",
      "name": "Landing Page",
      "description": "Create landing page with hero and prompt input",
      "priority": "P0",
      "phase": 8,
      "effort": "6h",
      "passes": true,
      "category": "frontend",
      "files": [
        "apps/web/src/app/page.tsx"
      ],
      "acceptance": [
        "Hero section",
        "Prompt input",
        "Features grid",
        "CTA"
      ]
    },
    {
      "id": "UI-002",
      "name": "Pricing Page",
      "description": "Create pricing page with credit packs and subscriptions",
      "priority": "P0",
      "phase": 8,
      "effort": "4h",
      "passes": true,
      "category": "frontend",
      "files": [
        "apps/web/src/app/pricing/page.tsx"
      ],
      "acceptance": [
        "Shows all pricing options",
        "Toggle between one-time and subscription"
      ]
    },
    {
      "id": "UI-003",
      "name": "Dashboard Page",
      "description": "Create /app dashboard with project list",
      "priority": "P0",
      "phase": 8,
      "effort": "6h",
      "passes": true,
      "category": "frontend",
      "files": [
        "apps/web/src/app/app/page.tsx"
      ],
      "acceptance": [
        "Lists projects",
        "Shows credit balance",
        "New project card"
      ]
    },
    {
      "id": "UI-004",
      "name": "New Project Page",
      "description": "Create /app/new page for video creation",
      "priority": "P0",
      "phase": 8,
      "effort": "6h",
      "passes": true,
      "category": "frontend",
      "files": [
        "apps/web/src/app/app/new/page.tsx"
      ],
      "acceptance": [
        "Form with prompt input",
        "Niche selector",
        "Duration picker",
        "Submits to API"
      ]
    },
    {
      "id": "UI-005",
      "name": "Job Progress Page",
      "description": "Create /app/jobs/[id] page with stepper",
      "priority": "P0",
      "phase": 8,
      "effort": "6h",
      "passes": true,
      "category": "frontend",
      "files": [
        "apps/web/src/app/app/jobs/[id]/page.tsx"
      ],
      "acceptance": [
        "Shows progress stepper",
        "Real-time updates",
        "Download section when ready"
      ]
    },
    {
      "id": "UI-006",
      "name": "Credits Page",
      "description": "Create /app/credits page for balance and purchase",
      "priority": "P0",
      "phase": 8,
      "effort": "4h",
      "passes": true,
      "category": "frontend",
      "files": [
        "apps/web/src/app/app/credits/page.tsx"
      ],
      "acceptance": [
        "Shows balance",
        "Purchase options",
        "Transaction history"
      ]
    },
    {
      "id": "UI-007",
      "name": "Settings Page",
      "description": "Create /app/settings page for user preferences",
      "priority": "P1",
      "phase": 8,
      "effort": "3h",
      "passes": true,
      "category": "frontend",
      "files": [
        "apps/web/src/app/app/settings/page.tsx"
      ],
      "acceptance": [
        "Profile settings",
        "Notification preferences",
        "Subscription management"
      ]
    },
    {
      "id": "UI-008",
      "name": "App Layout",
      "description": "Create /app layout with navigation",
      "priority": "P0",
      "phase": 8,
      "effort": "3h",
      "passes": true,
      "category": "frontend",
      "files": [
        "apps/web/src/app/app/layout.tsx"
      ],
      "acceptance": [
        "Sidebar navigation",
        "User menu",
        "Credit display"
      ]
    },
    {
      "id": "UI-009",
      "name": "JobStepper Component",
      "description": "Create real-time job progress stepper",
      "priority": "P0",
      "phase": 8,
      "effort": "4h",
      "passes": true,
      "category": "frontend",
      "files": [
        "apps/web/src/components/job-stepper.tsx"
      ],
      "acceptance": [
        "Shows 9 steps",
        "Highlights current",
        "Shows progress %"
      ]
    },
    {
      "id": "UI-010",
      "name": "CreditBalance Component",
      "description": "Create credit balance display component",
      "priority": "P0",
      "phase": 8,
      "effort": "2h",
      "passes": true,
      "category": "frontend",
      "files": [
        "apps/web/src/components/credit-balance.tsx"
      ],
      "acceptance": [
        "Shows balance",
        "Link to purchase"
      ]
    },
    {
      "id": "UI-011",
      "name": "ProjectCard Component",
      "description": "Create project card for dashboard",
      "priority": "P0",
      "phase": 8,
      "effort": "2h",
      "passes": true,
      "category": "frontend",
      "files": [
        "apps/web/src/components/project-card.tsx"
      ],
      "acceptance": [
        "Shows project info",
        "Status badge",
        "Link to project"
      ]
    },
    {
      "id": "UI-012",
      "name": "PricingCard Component",
      "description": "Create pricing card component",
      "priority": "P0",
      "phase": 8,
      "effort": "2h",
      "passes": true,
      "category": "frontend",
      "files": [
        "apps/web/src/components/pricing-card.tsx"
      ],
      "acceptance": [
        "Shows price and features",
        "CTA button"
      ]
    },
    {
      "id": "UI-013",
      "name": "VideoPlayer Component",
      "description": "Create video player for preview and download",
      "priority": "P0",
      "phase": 8,
      "effort": "3h",
      "passes": true,
      "category": "frontend",
      "files": [
        "apps/web/src/components/video-player.tsx"
      ],
      "acceptance": [
        "Plays MP4",
        "Download button",
        "Fullscreen"
      ]
    },
    {
      "id": "UI-014",
      "name": "useJobStatus Hook",
      "description": "Create hook for polling job status",
      "priority": "P0",
      "phase": 8,
      "effort": "2h",
      "passes": true,
      "category": "frontend",
      "files": [
        "apps/web/src/hooks/useJobStatus.ts"
      ],
      "acceptance": [
        "Polls every 3s",
        "Stops on complete/failed"
      ]
    },
    {
      "id": "UI-015",
      "name": "useCredits Hook",
      "description": "Create hook for fetching credit balance",
      "priority": "P0",
      "phase": 8,
      "effort": "1h",
      "passes": true,
      "category": "frontend",
      "files": [
        "apps/web/src/hooks/useCredits.ts"
      ],
      "acceptance": [
        "Fetches balance via RPC",
        "Handles loading state"
      ]
    },
    {
      "id": "UI-016",
      "name": "Tailwind Configuration",
      "description": "Configure Tailwind with custom theme",
      "priority": "P0",
      "phase": 8,
      "effort": "2h",
      "passes": true,
      "category": "frontend",
      "files": [
        "apps/web/tailwind.config.js"
      ],
      "acceptance": [
        "Custom colors",
        "Custom fonts",
        "Dark mode support"
      ]
    },
    {
      "id": "UI-017",
      "name": "shadcn/ui Setup",
      "description": "Install and configure shadcn/ui components",
      "priority": "P0",
      "phase": 8,
      "effort": "2h",
      "passes": true,
      "category": "frontend",
      "files": [
        "apps/web/src/components/ui/"
      ],
      "acceptance": [
        "Button, Input, Card, Dialog, etc. installed"
      ]
    },
    {
      "id": "BILLING-001",
      "name": "Stripe Client Setup",
      "description": "Initialize Stripe client in API",
      "priority": "P0",
      "phase": 9,
      "effort": "1h",
      "passes": true,
      "category": "billing",
      "files": [
        "apps/api/src/lib/stripe.ts"
      ],
      "acceptance": [
        "Client initialized",
        "Test mode working"
      ]
    },
    {
      "id": "BILLING-002",
      "name": "Credit Pack Products",
      "description": "Create Stripe products for credit packs",
      "priority": "P0",
      "phase": 9,
      "effort": "2h",
      "passes": true,
      "category": "billing",
      "files": [
        "apps/api/src/lib/stripe-products.ts"
      ],
      "acceptance": [
        "Starter, Creator, Pro packs configured"
      ]
    },
    {
      "id": "BILLING-003",
      "name": "Subscription Products",
      "description": "Create Stripe products for subscriptions",
      "priority": "P1",
      "phase": 9,
      "effort": "2h",
      "passes": true,
      "category": "billing",
      "files": [
        "apps/api/src/lib/stripe-products.ts"
      ],
      "acceptance": [
        "Hobbyist, Creator, Business plans configured"
      ]
    },
    {
      "id": "BILLING-004",
      "name": "Checkout Session Handler",
      "description": "Handle checkout.session.completed webhook",
      "priority": "P0",
      "phase": 9,
      "effort": "3h",
      "passes": true,
      "category": "billing",
      "files": [
        "apps/api/src/webhooks/stripe.ts"
      ],
      "acceptance": [
        "Credits added on payment",
        "Idempotent"
      ]
    },
    {
      "id": "BILLING-005",
      "name": "Invoice Paid Handler",
      "description": "Handle invoice.paid webhook for subscriptions",
      "priority": "P1",
      "phase": 9,
      "effort": "2h",
      "passes": true,
      "category": "billing",
      "files": [
        "apps/api/src/webhooks/stripe.ts"
      ],
      "acceptance": [
        "Monthly credits added",
        "Subscription updated"
      ]
    },
    {
      "id": "BILLING-006",
      "name": "Subscription Updated Handler",
      "description": "Handle subscription update webhooks",
      "priority": "P1",
      "phase": 9,
      "effort": "2h",
      "passes": true,
      "category": "billing",
      "files": [
        "apps/api/src/webhooks/stripe.ts"
      ],
      "acceptance": [
        "Status changes tracked",
        "Plan changes handled"
      ]
    },
    {
      "id": "EMAIL-001",
      "name": "Email Queue Setup",
      "description": "Create BullMQ queue for email jobs",
      "priority": "P1",
      "phase": 10,
      "effort": "2h",
      "passes": true,
      "category": "email",
      "files": [
        "apps/worker/src/queues/email.ts"
      ],
      "acceptance": [
        "Queue created",
        "Worker processes emails"
      ]
    },
    {
      "id": "EMAIL-002",
      "name": "Resend Client Setup",
      "description": "Initialize Resend email client",
      "priority": "P1",
      "phase": 10,
      "effort": "1h",
      "passes": true,
      "category": "email",
      "files": [
        "apps/worker/src/lib/resend.ts"
      ],
      "acceptance": [
        "Client initialized",
        "Test email works"
      ]
    },
    {
      "id": "EMAIL-003",
      "name": "Welcome Email Template",
      "description": "Create welcome email for new users",
      "priority": "P1",
      "phase": 10,
      "effort": "2h",
      "passes": true,
      "category": "email",
      "files": [
        "apps/worker/src/templates/welcome.tsx"
      ],
      "acceptance": [
        "React email template",
        "Shows trial credits"
      ]
    },
    {
      "id": "EMAIL-004",
      "name": "Job Complete Email Template",
      "description": "Create email for completed videos",
      "priority": "P1",
      "phase": 10,
      "effort": "2h",
      "passes": true,
      "category": "email",
      "files": [
        "apps/worker/src/templates/job-complete.tsx"
      ],
      "acceptance": [
        "Shows project title",
        "Download link"
      ]
    },
    {
      "id": "EMAIL-005",
      "name": "Job Failed Email Template",
      "description": "Create email for failed jobs",
      "priority": "P1",
      "phase": 10,
      "effort": "2h",
      "passes": true,
      "category": "email",
      "files": [
        "apps/worker/src/templates/job-failed.tsx"
      ],
      "acceptance": [
        "Shows error info",
        "Credits refunded message"
      ]
    },
    {
      "id": "EMAIL-006",
      "name": "Purchase Confirmation Email",
      "description": "Create email for credit purchases",
      "priority": "P1",
      "phase": 10,
      "effort": "2h",
      "passes": true,
      "category": "email",
      "files": [
        "apps/worker/src/templates/purchase-confirmation.tsx"
      ],
      "acceptance": [
        "Shows credits added",
        "Receipt info"
      ]
    },
    {
      "id": "EMAIL-007",
      "name": "Notify Service",
      "description": "Create notification service for queueing emails",
      "priority": "P1",
      "phase": 10,
      "effort": "2h",
      "passes": true,
      "category": "email",
      "files": [
        "apps/worker/src/notify.ts"
      ],
      "acceptance": [
        "Queues emails by type",
        "Handles user lookup"
      ]
    },
    {
      "id": "STORAGE-001",
      "name": "Supabase Storage Buckets",
      "description": "Create storage buckets for assets",
      "priority": "P0",
      "phase": 11,
      "effort": "2h",
      "passes": true,
      "category": "storage",
      "files": [
        "supabase/config.toml"
      ],
      "acceptance": [
        "generated-assets bucket",
        "temp-processing bucket",
        "RLS policies"
      ]
    },
    {
      "id": "STORAGE-002",
      "name": "Upload Service",
      "description": "Create service for uploading assets",
      "priority": "P0",
      "phase": 11,
      "effort": "3h",
      "passes": true,
      "category": "storage",
      "files": [
        "apps/worker/src/lib/storage.ts"
      ],
      "acceptance": [
        "Uploads files",
        "Returns public URLs"
      ]
    },
    {
      "id": "STORAGE-003",
      "name": "Asset Cleanup Job",
      "description": "Create job to clean up temp files",
      "priority": "P2",
      "phase": 11,
      "effort": "2h",
      "passes": true,
      "category": "storage",
      "files": [
        "apps/worker/src/jobs/cleanup.ts"
      ],
      "acceptance": [
        "Deletes old temp files",
        "Runs on schedule"
      ]
    },
    {
      "id": "TEST-001",
      "name": "Jest Setup",
      "description": "Configure Jest for unit testing",
      "priority": "P0",
      "phase": 12,
      "effort": "2h",
      "passes": true,
      "category": "testing",
      "files": [
        "jest.config.js",
        "packages/shared/__tests__/"
      ],
      "acceptance": [
        "Jest runs",
        "Coverage reporting"
      ]
    },
    {
      "id": "TEST-002",
      "name": "Playwright Setup",
      "description": "Configure Playwright for E2E testing",
      "priority": "P1",
      "phase": 12,
      "effort": "2h",
      "passes": true,
      "category": "testing",
      "files": [
        "playwright.config.ts",
        "e2e/"
      ],
      "acceptance": [
        "Playwright runs",
        "CI integration"
      ]
    },
    {
      "id": "TEST-003",
      "name": "Schema Validation Tests",
      "description": "Unit tests for Zod schemas",
      "priority": "P0",
      "phase": 12,
      "effort": "2h",
      "passes": true,
      "category": "testing",
      "files": [
        "packages/shared/__tests__/schemas.test.ts"
      ],
      "acceptance": [
        "All schemas tested",
        "Edge cases covered"
      ]
    },
    {
      "id": "TEST-004",
      "name": "Credit Functions Tests",
      "description": "Integration tests for credit RPC functions",
      "priority": "P0",
      "phase": 12,
      "effort": "3h",
      "passes": true,
      "category": "testing",
      "files": [
        "__tests__/integration/credits.test.ts"
      ],
      "acceptance": [
        "Reserve, finalize, release tested"
      ]
    },
    {
      "id": "TEST-005",
      "name": "API Endpoint Tests",
      "description": "Integration tests for API endpoints",
      "priority": "P0",
      "phase": 12,
      "effort": "4h",
      "passes": true,
      "category": "testing",
      "files": [
        "apps/api/__tests__/"
      ],
      "acceptance": [
        "All endpoints tested",
        "Auth tested"
      ]
    },
    {
      "id": "TEST-006",
      "name": "Pipeline Step Tests",
      "description": "Unit tests for pipeline steps with mocks",
      "priority": "P1",
      "phase": 12,
      "effort": "4h",
      "passes": true,
      "category": "testing",
      "files": [
        "apps/worker/__tests__/pipeline/"
      ],
      "acceptance": [
        "Each step tested",
        "External APIs mocked"
      ]
    },
    {
      "id": "TEST-007",
      "name": "Auth Flow E2E Tests",
      "description": "E2E tests for signup/login flows",
      "priority": "P1",
      "phase": 12,
      "effort": "3h",
      "passes": true,
      "category": "testing",
      "files": [
        "e2e/auth.spec.ts"
      ],
      "acceptance": [
        "Signup works",
        "Login works",
        "Draft claim works"
      ]
    },
    {
      "id": "TEST-008",
      "name": "Project Creation E2E Tests",
      "description": "E2E tests for project creation flow",
      "priority": "P1",
      "phase": 12,
      "effort": "3h",
      "passes": true,
      "category": "testing",
      "files": [
        "e2e/projects.spec.ts"
      ],
      "acceptance": [
        "Can create project",
        "Shows in dashboard"
      ]
    },
    {
      "id": "TEST-009",
      "name": "Credit Purchase E2E Tests",
      "description": "E2E tests for credit purchase with Stripe test mode",
      "priority": "P2",
      "phase": 12,
      "effort": "3h",
      "passes": true,
      "category": "testing",
      "files": [
        "e2e/credits.spec.ts"
      ],
      "acceptance": [
        "Checkout redirect works",
        "Webhook simulated"
      ]
    },
    {
      "id": "MONITOR-001",
      "name": "Structured Logging",
      "description": "Implement structured JSON logging across all apps",
      "priority": "P1",
      "phase": 12,
      "effort": "3h",
      "passes": true,
      "category": "monitoring",
      "files": [
        "packages/shared/src/lib/logger.ts"
      ],
      "acceptance": [
        "JSON logs with trace IDs",
        "Log levels"
      ]
    },
    {
      "id": "MONITOR-002",
      "name": "Error Tracking",
      "description": "Add error tracking (Sentry or similar)",
      "priority": "P2",
      "phase": 12,
      "effort": "3h",
      "passes": true,
      "category": "monitoring",
      "files": [
        "apps/web/src/lib/sentry.ts",
        "apps/api/src/lib/sentry.ts"
      ],
      "acceptance": [
        "Errors captured",
        "Stack traces available"
      ]
    },
    {
      "id": "MONITOR-003",
      "name": "Queue Metrics Dashboard",
      "description": "Add BullMQ dashboard for job monitoring",
      "priority": "P2",
      "phase": 12,
      "effort": "2h",
      "passes": true,
      "category": "monitoring",
      "files": [
        "apps/api/src/bull-board.ts"
      ],
      "acceptance": [
        "Dashboard accessible",
        "Shows queue stats"
      ]
    },
    {
      "id": "DEPLOY-001",
      "name": "Docker Configuration",
      "description": "Create Dockerfiles for all apps",
      "priority": "P1",
      "phase": 12,
      "effort": "4h",
      "passes": true,
      "category": "deployment",
      "files": [
        "apps/web/Dockerfile",
        "apps/api/Dockerfile",
        "apps/worker/Dockerfile"
      ],
      "acceptance": [
        "All apps containerized",
        "docker-compose works"
      ]
    },
    {
      "id": "DEPLOY-002",
      "name": "CI/CD Pipeline",
      "description": "Create GitHub Actions workflow",
      "priority": "P1",
      "phase": 12,
      "effort": "4h",
      "passes": true,
      "category": "deployment",
      "files": [
        ".github/workflows/ci.yml",
        ".github/workflows/deploy.yml"
      ],
      "acceptance": [
        "Tests run on PR",
        "Auto-deploy on merge"
      ]
    },
    {
      "id": "DEPLOY-003",
      "name": "Environment Documentation",
      "description": "Document all environment variables",
      "priority": "P0",
      "phase": 12,
      "effort": "2h",
      "passes": true,
      "category": "deployment",
      "files": [
        "docs/ENVIRONMENT.md"
      ],
      "acceptance": [
        "All vars documented",
        "Setup instructions"
      ]
    },
    {
      "id": "RESIL-001",
      "name": "Partial Asset Recovery",
      "description": "Allow users to retry from last checkpoint if image gen succeeds but rendering fails",
      "priority": "P1",
      "phase": 13,
      "effort": "4h",
      "passes": true,
      "category": "resilience",
      "files": [
        "apps/worker/src/pipeline/recovery.ts",
        "apps/web/src/app/projects/[id]/retry/page.tsx"
      ],
      "acceptance": [
        "Checkpoint state saved",
        "Retry from checkpoint works",
        "UI shows retry options"
      ]
    },
    {
      "id": "RESIL-002",
      "name": "Credit Refund Policy",
      "description": "Automatic refunds for jobs that fail before completion threshold",
      "priority": "P1",
      "phase": 13,
      "effort": "3h",
      "passes": true,
      "category": "resilience",
      "files": [
        "apps/api/src/services/refund.ts",
        "packages/shared/src/constants.ts"
      ],
      "acceptance": [
        "Refund threshold configurable",
        "Credits restored on early failure",
        "Ledger entry created"
      ]
    },
    {
      "id": "RESIL-003",
      "name": "Dead Letter Queue",
      "description": "Jobs that fail 3+ times get flagged for manual review",
      "priority": "P1",
      "phase": 13,
      "effort": "3h",
      "passes": true,
      "category": "resilience",
      "files": [
        "apps/worker/src/queues/dead-letter.ts",
        "apps/api/src/routes/admin/dlq.ts"
      ],
      "acceptance": [
        "Failed jobs moved to DLQ",
        "Admin can view DLQ",
        "Retry from DLQ works"
      ]
    },
    {
      "id": "RESIL-004",
      "name": "User Self-Service Retry",
      "description": "UI to retry individual pipeline steps",
      "priority": "P2",
      "phase": 13,
      "effort": "4h",
      "passes": true,
      "category": "resilience",
      "files": [
        "apps/web/src/components/RetryStepButton.tsx",
        "apps/api/src/services/retry-step.ts",
        "apps/worker/src/pipeline/runner.ts"
      ],
      "acceptance": [
        "Retry button per step",
        "Step re-executes",
        "Progress updates"
      ]
    },
    {
      "id": "MOD-001",
      "name": "Prompt Content Filter",
      "description": "Filter prompts for prohibited content before job creation using OpenAI moderation",
      "priority": "P0",
      "phase": 14,
      "effort": "3h",
      "passes": true,
      "category": "moderation",
      "files": [
        "packages/shared/src/moderation.ts",
        "apps/api/src/middleware/moderation.ts"
      ],
      "acceptance": [
        "Moderation API called",
        "Blocked prompts rejected",
        "Clear error message"
      ]
    },
    {
      "id": "MOD-002",
      "name": "Output Content Scanning",
      "description": "Check generated scripts and images for policy violations",
      "priority": "P1",
      "phase": 14,
      "effort": "4h",
      "passes": true,
      "category": "moderation",
      "files": [
        "apps/worker/src/pipeline/steps/moderate-output.ts"
      ],
      "acceptance": [
        "Scripts scanned",
        "Images checked",
        "Violations flagged"
      ]
    },
    {
      "id": "MOD-003",
      "name": "Audit Trail",
      "description": "Store original prompts for compliance review",
      "priority": "P1",
      "phase": 14,
      "effort": "2h",
      "passes": true,
      "category": "moderation",
      "files": [
        "supabase/migrations/audit_log.sql"
      ],
      "acceptance": [
        "Prompts logged",
        "Immutable audit table",
        "Searchable by admin"
      ]
    },
    {
      "id": "MOD-004",
      "name": "Appeal Process",
      "description": "User path to contest blocked content",
      "priority": "P2",
      "phase": 14,
      "effort": "4h",
      "passes": true,
      "category": "moderation",
      "files": [
        "apps/web/src/app/appeal/page.tsx",
        "apps/api/src/routes/appeals.ts"
      ],
      "acceptance": [
        "Appeal form works",
        "Admin review queue",
        "User notified of decision"
      ]
    },
    {
      "id": "ANALYTICS-001",
      "name": "PostHog Integration",
      "description": "Initialize PostHog client for event tracking",
      "priority": "P1",
      "phase": 15,
      "effort": "2h",
      "passes": true,
      "category": "analytics",
      "files": [
        "apps/web/src/lib/analytics.ts",
        "apps/web/src/app/layout.tsx"
      ],
      "acceptance": [
        "PostHog initialized",
        "Page views tracked",
        "User identified"
      ]
    },
    {
      "id": "ANALYTICS-002",
      "name": "Funnel Metrics",
      "description": "Track landing \u2192 signup \u2192 first_video \u2192 paid_conversion funnel",
      "priority": "P1",
      "phase": 15,
      "effort": "3h",
      "passes": true,
      "category": "analytics",
      "files": [
        "apps/web/src/lib/analytics.ts"
      ],
      "acceptance": [
        "All funnel events tracked",
        "Conversion visible in PostHog"
      ]
    },
    {
      "id": "ANALYTICS-003",
      "name": "Pipeline Health Metrics",
      "description": "Track success rates per step, avg duration, failure reasons",
      "priority": "P1",
      "phase": 15,
      "effort": "3h",
      "passes": true,
      "category": "analytics",
      "files": [
        "apps/worker/src/pipeline/metrics.ts"
      ],
      "acceptance": [
        "Step durations tracked",
        "Failure reasons categorized",
        "Dashboard available"
      ]
    },
    {
      "id": "ANALYTICS-004",
      "name": "Cost Tracking",
      "description": "Track API costs per job (OpenAI, image gen, storage)",
      "priority": "P1",
      "phase": 15,
      "effort": "4h",
      "passes": true,
      "category": "analytics",
      "files": [
        "apps/worker/src/services/cost-tracker.ts",
        "supabase/migrations/job_costs.sql"
      ],
      "acceptance": [
        "Costs calculated per job",
        "Stored in database",
        "Visible in admin"
      ]
    },
    {
      "id": "ADMIN-001",
      "name": "Admin Dashboard Layout",
      "description": "Create admin area with navigation and auth check",
      "priority": "P2",
      "phase": 16,
      "effort": "3h",
      "passes": true,
      "category": "admin",
      "files": [
        "apps/web/src/app/admin/layout.tsx",
        "apps/web/src/middleware.ts"
      ],
      "acceptance": [
        "Admin route protected",
        "Navigation works",
        "Role check enforced"
      ]
    },
    {
      "id": "ADMIN-002",
      "name": "Job Inspector",
      "description": "View any job's pipeline state, logs, artifacts",
      "priority": "P2",
      "phase": 16,
      "effort": "4h",
      "passes": true,
      "category": "admin",
      "files": [
        "apps/web/src/app/admin/jobs/[id]/page.tsx"
      ],
      "acceptance": [
        "Job details visible",
        "Step logs shown",
        "Artifacts downloadable"
      ]
    },
    {
      "id": "ADMIN-003",
      "name": "User Management",
      "description": "Credit adjustments and account status management",
      "priority": "P2",
      "phase": 16,
      "effort": "4h",
      "passes": true,
      "category": "admin",
      "files": [
        "apps/web/src/app/admin/users/page.tsx",
        "apps/api/src/routes/admin/users.ts"
      ],
      "acceptance": [
        "User list with search",
        "Credit adjustment works",
        "Account status toggle"
      ]
    },
    {
      "id": "ADMIN-004",
      "name": "Queue Health Dashboard",
      "description": "Worker status, pending jobs, stuck jobs overview",
      "priority": "P2",
      "phase": 16,
      "effort": "3h",
      "passes": true,
      "category": "admin",
      "files": [
        "apps/web/src/app/admin/queues/page.tsx"
      ],
      "acceptance": [
        "Queue stats visible",
        "Stuck jobs highlighted",
        "Retry actions available"
      ]
    },
    {
      "id": "ADMIN-005",
      "name": "Cost Dashboard",
      "description": "Daily/weekly API spend by service",
      "priority": "P2",
      "phase": 16,
      "effort": "3h",
      "passes": true,
      "category": "admin",
      "files": [
        "apps/web/src/app/admin/costs/page.tsx"
      ],
      "acceptance": [
        "Cost charts rendered",
        "Breakdown by service",
        "Date range filter"
      ]
    },
    {
      "id": "DOC-001",
      "name": "PDF Extraction",
      "description": "Extract text from uploaded PDF files using pdf-parse",
      "priority": "P1",
      "phase": 17,
      "effort": "3h",
      "passes": true,
      "category": "documents",
      "files": [
        "apps/worker/src/pipeline/steps/ingest-inputs.ts",
        "package.json"
      ],
      "acceptance": [
        "PDF text extracted",
        "Formatting preserved",
        "Error handling"
      ]
    },
    {
      "id": "DOC-002",
      "name": "DOCX Support",
      "description": "Extract text from Word documents using mammoth.js",
      "priority": "P1",
      "phase": 17,
      "effort": "3h",
      "passes": true,
      "category": "documents",
      "files": [
        "apps/worker/src/pipeline/steps/ingest-inputs.ts"
      ],
      "acceptance": [
        "DOCX text extracted",
        "Styles handled",
        "Tables converted"
      ]
    },
    {
      "id": "DOC-003",
      "name": "Audio Transcription",
      "description": "Transcribe voice notes using Whisper API",
      "priority": "P2",
      "phase": 17,
      "effort": "4h",
      "passes": true,
      "category": "documents",
      "files": [
        "apps/worker/src/services/transcription.ts"
      ],
      "acceptance": [
        "Audio transcribed",
        "Timestamps available",
        "Speaker detection"
      ]
    },
    {
      "id": "DOC-004",
      "name": "URL Content Scraping",
      "description": "Extract content from blog post URLs",
      "priority": "P2",
      "phase": 17,
      "effort": "3h",
      "passes": true,
      "category": "documents",
      "files": [
        "apps/worker/src/services/url-scraper.ts"
      ],
      "acceptance": [
        "Article content extracted",
        "Metadata parsed",
        "Images referenced"
      ]
    },
    {
      "id": "DOC-005",
      "name": "File Size Limits",
      "description": "Enforce max 10MB per file, 50MB total per project",
      "priority": "P1",
      "phase": 17,
      "effort": "2h",
      "passes": true,
      "category": "documents",
      "files": [
        "apps/api/src/middleware/upload-limits.ts"
      ],
      "acceptance": [
        "Size validation works",
        "Clear error messages",
        "Configurable limits"
      ]
    },
    {
      "id": "REMOTION-005",
      "name": "Template Variants",
      "description": "Multiple visual styles per niche preset",
      "priority": "P2",
      "phase": 18,
      "effort": "6h",
      "passes": true,
      "category": "remotion",
      "files": [
        "packages/remotion/src/templates/"
      ],
      "acceptance": [
        "3+ templates per niche",
        "Template selector UI",
        "Preview thumbnails"
      ]
    },
    {
      "id": "REMOTION-006",
      "name": "Preview Generation",
      "description": "Quick thumbnail/preview before full render",
      "priority": "P2",
      "phase": 18,
      "effort": "3h",
      "passes": true,
      "category": "remotion",
      "files": [
        "apps/worker/src/pipeline/steps/generate-preview.ts"
      ],
      "acceptance": [
        "Preview in <10s",
        "Thumbnail saved",
        "Shown in UI"
      ]
    },
    {
      "id": "RATE-001",
      "name": "Upstash Rate Limiter",
      "description": "Initialize Upstash Redis rate limiting",
      "priority": "P0",
      "phase": 19,
      "effort": "2h",
      "passes": true,
      "category": "rate-limiting",
      "files": [
        "apps/api/src/lib/ratelimit.ts",
        "package.json"
      ],
      "acceptance": [
        "Upstash connected",
        "Rate limit works",
        "429 returned"
      ],
      "notes": "Reset: was using MockRedis fallback instead of real Redis/Upstash rate limiting"
    },
    {
      "id": "RATE-002",
      "name": "Draft Endpoint Rate Limit",
      "description": "Rate limit /api/draft to prevent spam",
      "priority": "P0",
      "phase": 19,
      "effort": "1h",
      "passes": true,
      "category": "rate-limiting",
      "files": [
        "apps/web/src/app/api/draft/route.ts"
      ],
      "acceptance": [
        "10 req/min per IP",
        "Clear error message",
        "Bypass for auth users"
      ],
      "notes": "Reset: was using MockRedis fallback instead of real Redis/Upstash rate limiting"
    },
    {
      "id": "RATE-003",
      "name": "Job Creation Rate Limit",
      "description": "Per-user limits on job creation",
      "priority": "P1",
      "phase": 19,
      "effort": "2h",
      "passes": true,
      "category": "rate-limiting",
      "files": [
        "apps/api/src/routes/jobs.ts"
      ],
      "acceptance": [
        "User-based limits",
        "Configurable per plan",
        "Clear feedback"
      ],
      "notes": "Reset: was using MockRedis fallback instead of real Redis/Upstash rate limiting"
    },
    {
      "id": "RATE-004",
      "name": "API Key Rate Limits",
      "description": "Rate limiting for API key access",
      "priority": "P2",
      "phase": 19,
      "effort": "3h",
      "passes": true,
      "category": "rate-limiting",
      "files": [
        "apps/api/src/middleware/api-key-limit.ts",
        "apps/api/src/routes/api-keys.ts",
        "supabase/migrations/20260120000020_api_keys.sql",
        "supabase/migrations/20260120000021_api_key_usage_notifications.sql",
        "packages/shared/src/schemas/api-key.ts",
        "packages/shared/src/types.ts"
      ],
      "acceptance": [
        "Per-key limits",
        "Usage tracking",
        "Webhook notifications"
      ],
      "notes": "Reset: was using MockRedis fallback instead of real Redis/Upstash rate limiting"
    },
    {
      "id": "GDPR-001",
      "name": "Asset Retention Policy",
      "description": "Auto-delete job assets after configurable days",
      "priority": "P1",
      "phase": 20,
      "effort": "4h",
      "passes": true,
      "category": "gdpr",
      "files": [
        "apps/worker/src/jobs/cleanup-assets.ts",
        "supabase/migrations/retention.sql"
      ],
      "acceptance": [
        "Cron job runs",
        "Old assets deleted",
        "User notified before deletion"
      ]
    },
    {
      "id": "GDPR-002",
      "name": "Account Deletion",
      "description": "User can request full data deletion",
      "priority": "P1",
      "phase": 20,
      "effort": "4h",
      "passes": true,
      "category": "gdpr",
      "files": [
        "apps/web/src/app/settings/delete-account/page.tsx",
        "apps/api/src/routes/account/delete.ts"
      ],
      "acceptance": [
        "Deletion request flow",
        "All data removed",
        "Confirmation email"
      ]
    },
    {
      "id": "GDPR-003",
      "name": "Data Export",
      "description": "User can download all their data",
      "priority": "P1",
      "phase": 20,
      "effort": "4h",
      "passes": true,
      "category": "gdpr",
      "files": [
        "apps/api/src/routes/account/export.ts"
      ],
      "acceptance": [
        "Export includes all data",
        "ZIP download",
        "JSON format"
      ]
    },
    {
      "id": "GDPR-004",
      "name": "Cookie Consent",
      "description": "GDPR-compliant consent banner",
      "priority": "P1",
      "phase": 20,
      "effort": "3h",
      "passes": true,
      "category": "gdpr",
      "files": [
        "apps/web/src/components/CookieConsent.tsx"
      ],
      "acceptance": [
        "Banner shown",
        "Preferences saved",
        "Analytics respects choice"
      ]
    },
    {
      "id": "GDPR-005",
      "name": "Privacy Policy Page",
      "description": "Document data handling practices",
      "priority": "P1",
      "phase": 20,
      "effort": "2h",
      "passes": true,
      "category": "gdpr",
      "files": [
        "apps/web/src/app/privacy/page.tsx"
      ],
      "acceptance": [
        "Policy comprehensive",
        "Last updated date",
        "Contact info"
      ]
    },
    {
      "id": "A11Y-001",
      "name": "WCAG Compliance Audit",
      "description": "Document and fix WCAG 2.1 AA violations",
      "priority": "P2",
      "phase": 21,
      "effort": "4h",
      "passes": true,
      "category": "accessibility",
      "files": [
        "docs/ACCESSIBILITY.md"
      ],
      "acceptance": [
        "Audit completed",
        "Issues documented",
        "Fix plan created"
      ]
    },
    {
      "id": "A11Y-002",
      "name": "Keyboard Navigation",
      "description": "Full keyboard navigation for all flows",
      "priority": "P2",
      "phase": 21,
      "effort": "4h",
      "passes": true,
      "category": "accessibility",
      "files": [
        "apps/web/src/components/"
      ],
      "acceptance": [
        "Tab order correct",
        "Focus visible",
        "Skip links work"
      ]
    },
    {
      "id": "A11Y-003",
      "name": "Screen Reader Testing",
      "description": "Test and fix screen reader compatibility",
      "priority": "P2",
      "phase": 21,
      "effort": "4h",
      "passes": true,
      "category": "accessibility",
      "files": [
        "apps/web/src/components/"
      ],
      "acceptance": [
        "ARIA labels correct",
        "Announcements work",
        "Forms accessible"
      ]
    },
    {
      "id": "A11Y-004",
      "name": "Color Contrast",
      "description": "Ensure all text meets contrast requirements",
      "priority": "P2",
      "phase": 21,
      "effort": "2h",
      "passes": true,
      "category": "accessibility",
      "files": [
        "apps/web/src/app/globals.css",
        "__tests__/accessibility/color-contrast.test.ts",
        "packages/shared/src/accessibility/contrast.ts",
        "docs/ACCESSIBILITY.md"
      ],
      "acceptance": [
        "4.5:1 ratio for text",
        "3:1 for large text",
        "Tools verify"
      ]
    },
    {
      "id": "A11Y-005",
      "name": "Focus Management",
      "description": "Proper focus management in modals and dynamic content",
      "priority": "P2",
      "phase": 21,
      "effort": "3h",
      "passes": true,
      "category": "accessibility",
      "files": [
        "apps/web/src/components/Modal.tsx"
      ],
      "acceptance": [
        "Focus trapped in modals",
        "Focus restored on close",
        "Dynamic content announced"
      ]
    },
    {
      "id": "TRACK-001",
      "name": "Tracking SDK Integration",
      "description": "Install and initialize user event tracking SDK from ACD",
      "category": "tracking",
      "priority": "P1",
      "passes": true
    },
    {
      "id": "TRACK-002",
      "name": "Acquisition Event Tracking",
      "description": "Track landing_view, cta_click, pricing_view with UTM params",
      "category": "tracking",
      "priority": "P1",
      "passes": true
    },
    {
      "id": "TRACK-003",
      "name": "Activation Event Tracking",
      "description": "Track signup_start, login_success, activation_complete",
      "category": "tracking",
      "priority": "P1",
      "passes": true
    },
    {
      "id": "TRACK-004",
      "name": "Core Value Event Tracking",
      "description": "Track product-specific value events (created, completed, downloaded)",
      "category": "tracking",
      "priority": "P1",
      "passes": true
    },
    {
      "id": "TRACK-005",
      "name": "Monetization Event Tracking",
      "description": "Track checkout_started, purchase_completed, subscription events",
      "category": "tracking",
      "priority": "P1",
      "passes": true
    },
    {
      "id": "TRACK-006",
      "name": "Retention Event Tracking",
      "description": "Track return_session, returning_user product events",
      "category": "tracking",
      "priority": "P2",
      "passes": true
    },
    {
      "id": "TRACK-007",
      "name": "Error & Performance Tracking",
      "description": "Track errors, API failures, and Core Web Vitals",
      "category": "tracking",
      "priority": "P2",
      "passes": true
    },
    {
      "id": "TRACK-008",
      "name": "User Identification",
      "description": "Identify users on login with traits (email, plan, etc.)",
      "category": "tracking",
      "priority": "P1",
      "passes": true
    },
    {
      "id": "META-001",
      "name": "Meta Pixel Installation",
      "description": "Install Facebook Pixel script in app layout",
      "category": "meta-pixel",
      "priority": "P1",
      "passes": true
    },
    {
      "id": "META-002",
      "name": "PageView Tracking",
      "description": "Track all page views with Meta Pixel",
      "category": "meta-pixel",
      "priority": "P1",
      "passes": true
    },
    {
      "id": "META-003",
      "name": "Standard Events Mapping",
      "description": "Map app events to Meta standard events (Purchase, Lead, etc.)",
      "category": "meta-pixel",
      "priority": "P1",
      "passes": true
    },
    {
      "id": "META-004",
      "name": "CAPI Server-Side Events",
      "description": "Implement Conversions API for server-side event tracking",
      "category": "meta-pixel",
      "priority": "P1",
      "passes": true
    },
    {
      "id": "META-005",
      "name": "Event Deduplication",
      "description": "Use event_id to deduplicate browser and server events",
      "category": "meta-pixel",
      "priority": "P1",
      "passes": true
    },
    {
      "id": "META-006",
      "name": "User Data Hashing (PII)",
      "description": "Hash email/phone with SHA256 for CAPI user matching",
      "category": "meta-pixel",
      "priority": "P1",
      "passes": true
    },
    {
      "id": "META-007",
      "name": "Custom Audiences Setup",
      "description": "Configure custom audiences based on user behavior",
      "category": "meta-pixel",
      "priority": "P2",
      "passes": true
    },
    {
      "id": "META-008",
      "name": "Conversion Optimization",
      "description": "Set up conversion optimization for key events",
      "category": "meta-pixel",
      "priority": "P2",
      "passes": true
    },
    {
      "id": "GDP-001",
      "name": "Supabase Schema Setup",
      "description": "Create person, identity_link, event, email_message, email_event, subscription, deal, person_features, segment tables",
      "category": "growth-data-plane",
      "priority": "P0",
      "passes": true
    },
    {
      "id": "GDP-002",
      "name": "Person & Identity Tables",
      "description": "Canonical person table with identity links for posthog, stripe, meta",
      "category": "growth-data-plane",
      "priority": "P0",
      "passes": true
    },
    {
      "id": "GDP-003",
      "name": "Unified Events Table",
      "description": "Normalized events from web/app/email/stripe/booking/meta sources",
      "category": "growth-data-plane",
      "priority": "P0",
      "passes": true
    },
    {
      "id": "GDP-004",
      "name": "Resend Webhook Edge Function",
      "description": "Verify Svix signature, store email events, map tags to person_id",
      "category": "growth-data-plane",
      "priority": "P0",
      "passes": true
    },
    {
      "id": "GDP-005",
      "name": "Email Event Tracking",
      "description": "Track delivered/opened/clicked/bounced events from Resend webhooks",
      "category": "growth-data-plane",
      "priority": "P0",
      "passes": true
    },
    {
      "id": "GDP-006",
      "name": "Click Redirect Tracker",
      "description": "Attribution spine: email \u2192 click \u2192 session \u2192 conversion with first-party cookie",
      "category": "growth-data-plane",
      "priority": "P1",
      "passes": true
    },
    {
      "id": "GDP-007",
      "name": "Stripe Webhook Integration",
      "description": "Handle subscription events, map stripe_customer_id to person_id",
      "category": "growth-data-plane",
      "priority": "P1",
      "passes": true
    },
    {
      "id": "GDP-008",
      "name": "Subscription Snapshot",
      "description": "Upsert subscription status, plan, MRR from Stripe events",
      "category": "growth-data-plane",
      "priority": "P1",
      "passes": true
    },
    {
      "id": "GDP-009",
      "name": "PostHog Identity Stitching",
      "description": "Call posthog.identify(personId) on login/signup",
      "category": "growth-data-plane",
      "priority": "P1",
      "passes": true
    },
    {
      "id": "GDP-010",
      "name": "Meta Pixel + CAPI Dedup",
      "description": "Fire Pixel eventID matching CAPI event_id for deduplication",
      "category": "growth-data-plane",
      "priority": "P1",
      "passes": true
    },
    {
      "id": "GDP-011",
      "name": "Person Features Computation",
      "description": "Compute active_days, core_actions, pricing_views, email_opens from events",
      "category": "growth-data-plane",
      "priority": "P1",
      "passes": true
    },
    {
      "id": "GDP-012",
      "name": "Segment Engine",
      "description": "Evaluate segment membership and trigger automations (Resend, Meta, outbound)",
      "category": "growth-data-plane",
      "priority": "P1",
      "passes": true
    },
    {
      "id": "NOMOCK-001",
      "name": "Replace MockRedis with Real In-Memory Rate Limiter",
      "description": "Remove MockRedis class from apps/api/src/lib/ratelimit-mock.ts and apps/web/src/lib/ratelimit.ts. Replace with a proper InMemoryRateLimiter class (not named 'Mock') or require UPSTASH_REDIS_REST_URL in production. Delete ratelimit-mock.ts entirely",
      "priority": "P0",
      "effort": "4h",
      "passes": true,
      "category": "api",
      "files": [
        "apps/api/src/lib/ratelimit-mock.ts",
        "apps/api/src/lib/ratelimit.ts",
        "apps/web/src/lib/ratelimit.ts"
      ],
      "acceptance": [
        "ratelimit-mock.ts deleted",
        "No class named MockRedis in any production source file",
        "Dev fallback uses InMemoryRateLimiter (proper naming, not Mock)",
        "Production requires UPSTASH_REDIS_REST_URL or throws ConfigError",
        "grep -r 'MockRedis\\|mock' apps/*/src/lib/ratelimit* returns zero results",
        "All rate limit tests pass"
      ]
    },
    {
      "id": "NOMOCK-002",
      "name": "Rate Limiting Integration Tests with Real Upstash",
      "description": "Add integration tests verifying rate limiting works correctly with real Upstash Redis, not just the in-memory fallback",
      "priority": "P1",
      "effort": "3h",
      "passes": true,
      "category": "api",
      "files": [
        "apps/api/src/lib/__tests__/ratelimit.test.ts"
      ],
      "acceptance": [
        "Tests verify rate limit counting with real Redis",
        "Tests verify rate limit reset timing",
        "Tests verify sliding window behavior",
        "Tests skip gracefully when UPSTASH_REDIS_REST_URL not available"
      ]
    }
  ]
}